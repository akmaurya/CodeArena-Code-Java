/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * ChallanEntry.java
 *
 * Created on Apr 20, 2012, 3:58:36 PM
 */

package railwaycashoffice;

import java.awt.Color;
import java.math.BigInteger;
import java.math.RoundingMode;

/**
 *
 * @author pratiksha
 */
public class ChallanEntry extends javax.swing.JInternalFrame {

    /** Creates new form ChallanEntry */
    boolean flag=true;
    public ChallanEntry(javax.swing.JDesktopPane jDesktopPane1) {
        initComponents();
//        javax.swing.JOptionPane.showMessageDialog(null,"Come inside");
        java.util.Date dt=new java.util.Date();
        int date=dt.getDate();
        int month=dt.getMonth()+1;
        int yr=dt.getYear()+1900;
        String setDate=date+"-"+month+"-"+yr;
        jLabel2.setText(setDate);
        jTextField1.setText("");
        jLabel14.setVisible(false);
        jComboBox2.setVisible(false);

        jTable1.setEnabled(false);
        jTable1.setAutoResizeMode(jTable1.AUTO_RESIZE_OFF);
        javax.swing.table.DefaultTableCellRenderer CRLeft=new javax.swing.table.DefaultTableCellRenderer();
        javax.swing.table.DefaultTableCellRenderer CRRight=new javax.swing.table.DefaultTableCellRenderer();
        javax.swing.table.DefaultTableCellRenderer CRCenter=new javax.swing.table.DefaultTableCellRenderer();


        CRLeft.setHorizontalAlignment(javax.swing.JLabel.LEFT);
        CRRight.setHorizontalAlignment(javax.swing.JLabel.RIGHT);
        CRCenter.setHorizontalAlignment(javax.swing.JLabel.CENTER);
        javax.swing.table.TableColumn column;

        //String head[]={"Sr. No.","Challan No.","Date"};
        //String head[]={"Sr. No.","Department","PMR No.","CO7","CO6","Amount","Bill Type"};
        String head[]={"Sr. No.","Department","PMR No.","CO7","CO6","Amount","Bill Type","Party Name"};
        dtm=new javax.swing.table.DefaultTableModel(head,0);
        jTable1.setModel(dtm);
         column=jTable1.getColumn("Sr. No.");
            column.setCellRenderer(CRRight);
            column.setPreferredWidth(50);
            column=jTable1.getColumn("Department");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(100);
            column=jTable1.getColumn("PMR No.");
            column.setCellRenderer(CRCenter);
            column.setPreferredWidth(60);
            column=jTable1.getColumn("CO7");
            column.setCellRenderer(CRCenter);
            column.setPreferredWidth(60);
            column=jTable1.getColumn("CO6");
            column.setCellRenderer(CRCenter);
            column.setPreferredWidth(60);
            column=jTable1.getColumn("Amount");
            column.setCellRenderer(CRRight);
            column.setPreferredWidth(100);
            column=jTable1.getColumn("Bill Type");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(80);
            column=jTable1.getColumn("Party Name");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(150);
            loadChallanNo();
            uploadChallanBookSheetNo();
         if(flag)
         {
              jDesktopPane1.add(this);
             //CE.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
              setBounds(50,50,929, 533);//504,550
              setVisible(true);
        }
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();
        jComboBox1 = new javax.swing.JComboBox();
        jLabel3 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jTextField1 = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        jLabel14 = new javax.swing.JLabel();
        jComboBox2 = new javax.swing.JComboBox();
        jLabel15 = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        jButton4 = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();

        setBackground(new java.awt.Color(222, 163, 205));
        setClosable(true);
        setIconifiable(true);
        setTitle("Challan Entry Window");
        getContentPane().setLayout(null);

        jLabel1.setBackground(new java.awt.Color(204, 204, 255));
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("Date");
        jLabel1.setOpaque(true);
        getContentPane().add(jLabel1);
        jLabel1.setBounds(30, 40, 200, 20);

        jLabel2.setBackground(new java.awt.Color(255, 255, 204));
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel2.setText("jLabel2");
        jLabel2.setOpaque(true);
        getContentPane().add(jLabel2);
        jLabel2.setBounds(230, 40, 210, 20);

        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/railwaycashoffice/images/calendar.png"))); // NOI18N
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton1);
        jButton1.setBounds(440, 40, 30, 25);

        jComboBox1.setToolTipText("Please select cashier number");
        jComboBox1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox1ActionPerformed(evt);
            }
        });
        jComboBox1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jComboBox1FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jComboBox1FocusLost(evt);
            }
        });
        jComboBox1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jComboBox1KeyPressed(evt);
            }
        });
        getContentPane().add(jComboBox1);
        jComboBox1.setBounds(130, 130, 140, 25);

        jLabel3.setBackground(new java.awt.Color(204, 204, 255));
        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jLabel3.setText("Challan Book Sheet No.");
        getContentPane().add(jLabel3);
        jLabel3.setBounds(30, 80, 200, 20);

        jLabel6.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel6.setText("0");
        jLabel6.setOpaque(true);
        getContentPane().add(jLabel6);
        jLabel6.setBounds(360, 130, 110, 25);

        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/railwaycashoffice/images/savefile.gif"))); // NOI18N
        jButton2.setMnemonic('S');
        jButton2.setText("Save & Print");
        jButton2.setToolTipText("Save & Print Information");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        jButton2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jButton2FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jButton2FocusLost(evt);
            }
        });
        jButton2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton2KeyPressed(evt);
            }
        });
        getContentPane().add(jButton2);
        jButton2.setBounds(30, 440, 200, 30);

        jButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/railwaycashoffice/images/Close1.gif"))); // NOI18N
        jButton3.setMnemonic('C');
        jButton3.setText("Close");
        jButton3.setToolTipText("Close");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });
        jButton3.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jButton3FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jButton3FocusLost(evt);
            }
        });
        getContentPane().add(jButton3);
        jButton3.setBounds(700, 440, 200, 30);

        jTextField1.setText("jTextField1");
        jTextField1.setToolTipText("Please input challan booksheet no.");
        jTextField1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jTextField1FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jTextField1FocusLost(evt);
            }
        });
        jTextField1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextField1KeyPressed(evt);
            }
        });
        getContentPane().add(jTextField1);
        jTextField1.setBounds(230, 80, 240, 25);

        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel4.setText("Challan No.");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(280, 130, 80, 25);

        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 11));
        jLabel5.setText("Today's Bill Amount(Cash + Cheque)");
        getContentPane().add(jLabel5);
        jLabel5.setBounds(30, 180, 240, 25);

        jLabel7.setBackground(new java.awt.Color(87, 152, 153));
        jLabel7.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel7.setText("0");
        jLabel7.setOpaque(true);
        getContentPane().add(jLabel7);
        jLabel7.setBounds(270, 180, 200, 25);

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 11));
        jLabel8.setText("Today's Cheque Amount                            -");
        getContentPane().add(jLabel8);
        jLabel8.setBounds(30, 280, 240, 25);

        jLabel9.setBackground(new java.awt.Color(176, 105, 89));
        jLabel9.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel9.setText("0");
        jLabel9.setOpaque(true);
        getContentPane().add(jLabel9);
        jLabel9.setBounds(270, 280, 200, 25);

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 11));
        jLabel10.setText("Last Due Amount                                        +");
        getContentPane().add(jLabel10);
        jLabel10.setBounds(30, 230, 240, 25);

        jLabel11.setBackground(new java.awt.Color(135, 147, 121));
        jLabel11.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel11.setText("0");
        jLabel11.setOpaque(true);
        getContentPane().add(jLabel11);
        jLabel11.setBounds(270, 230, 200, 25);

        jLabel12.setFont(new java.awt.Font("Tahoma", 1, 11));
        jLabel12.setText("Total Due Amount");
        getContentPane().add(jLabel12);
        jLabel12.setBounds(30, 380, 240, 25);

        jLabel13.setBackground(new java.awt.Color(168, 170, 112));
        jLabel13.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel13.setText("0");
        jLabel13.setOpaque(true);
        getContentPane().add(jLabel13);
        jLabel13.setBounds(270, 380, 200, 25);

        jLabel14.setBackground(new java.awt.Color(204, 204, 255));
        jLabel14.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel14.setText("Select Department");
        getContentPane().add(jLabel14);
        jLabel14.setBounds(30, 20, 200, 10);

        jComboBox2.setToolTipText("Please select department");
        jComboBox2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox2ActionPerformed(evt);
            }
        });
        jComboBox2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jComboBox2KeyPressed(evt);
            }
        });
        getContentPane().add(jComboBox2);
        jComboBox2.setBounds(230, 20, 240, 10);

        jLabel15.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel15.setText("Cashier Code");
        getContentPane().add(jLabel15);
        jLabel15.setBounds(30, 130, 100, 25);

        jPanel1.setBackground(new java.awt.Color(143, 171, 171));
        jPanel1.setLayout(null);

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane1.setViewportView(jTable1);

        jPanel1.add(jScrollPane1);
        jScrollPane1.setBounds(10, 20, 390, 320);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(490, 40, 410, 363);

        jLabel16.setFont(new java.awt.Font("Tahoma", 1, 11));
        jLabel16.setText("Total Cash Received By DC                         -");
        getContentPane().add(jLabel16);
        jLabel16.setBounds(30, 330, 240, 25);

        jLabel17.setBackground(new java.awt.Color(148, 201, 188));
        jLabel17.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel17.setText("0");
        jLabel17.setOpaque(true);
        getContentPane().add(jLabel17);
        jLabel17.setBounds(270, 330, 200, 25);

        jButton4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/railwaycashoffice/images/PRINT.GIF"))); // NOI18N
        jButton4.setMnemonic('P');
        jButton4.setText("Print");
        jButton4.setToolTipText("Print Information");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        jButton4.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jButton4FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jButton4FocusLost(evt);
            }
        });
        getContentPane().add(jButton4);
        jButton4.setBounds(250, 440, 200, 30);

        jButton5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/railwaycashoffice/images/delete.gif"))); // NOI18N
        jButton5.setMnemonic('E');
        jButton5.setText("Cancel Challan");
        jButton5.setToolTipText("Cancel Challan");
        jButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5ActionPerformed(evt);
            }
        });
        jButton5.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jButton5FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jButton5FocusLost(evt);
            }
        });
        getContentPane().add(jButton5);
        jButton5.setBounds(480, 440, 200, 30);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:

     if(jLabel6.getText().equals("0"))
     {
         javax.swing.JOptionPane.showMessageDialog(null,"Error ! Please input proper challan no. of this cashier.\nZero(0) challan no. is not acceptable.");
     }
     else
     {
         save();
     }
  
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
               Cal date1=new Cal();
           jLabel2.setText(date1.getdate());
           jComboBox2.requestFocus();
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jComboBox1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox1ActionPerformed
        // TODO add your handling code here:
        if(!jComboBox1.getSelectedItem().equals("Select"))
        {
            corresspondingChallan();
        }



    }//GEN-LAST:event_jComboBox1ActionPerformed

    private void jComboBox1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jComboBox1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
            jButton2.requestFocus();
          
         }
    }//GEN-LAST:event_jComboBox1KeyPressed

    private void jButton2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton2KeyPressed
        // TODO add your handling code here:
     if(evt.getKeyCode()==10)
     {
      
         save();
      
     }
    }//GEN-LAST:event_jButton2KeyPressed

    private void jComboBox2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox2ActionPerformed
        // TODO add your handling code here:
 //       uploadChallanBookSheetNo();
    }//GEN-LAST:event_jComboBox2ActionPerformed

    private void jComboBox2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jComboBox2KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
            jTextField1.requestFocus();
        }
    }//GEN-LAST:event_jComboBox2KeyPressed

    private void jTextField1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
            jComboBox1.requestFocus();
           
        }
    }//GEN-LAST:event_jTextField1KeyPressed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        // TODO add your handling code here:
          printDataNew PD=new printDataNew();
    }//GEN-LAST:event_jButton4ActionPerformed

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
        // TODO add your handling code here:
     if(jLabel6.getText().equals("0"))
     {
         javax.swing.JOptionPane.showMessageDialog(null,"Error ! Please input proper challan no. of this cashier.\nZero(0) challan no. is not acceptable.");
     }
     else
     {
         if(jLabel6.getBackground()==java.awt.Color.RED)
            cancelChallan();
         else
             javax.swing.JOptionPane.showMessageDialog(null,"Sorry ! Before cancelling you have to generate this challan.\nMay be this challan no. has not been generated till now.");
     }
    }//GEN-LAST:event_jButton5ActionPerformed

    private void jTextField1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jTextField1FocusGained
        // TODO add your handling code here:
    }//GEN-LAST:event_jTextField1FocusGained

    private void jTextField1FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jTextField1FocusLost
        // TODO add your handling code here:
         jTextField1.setBackground(Color.white);
    }//GEN-LAST:event_jTextField1FocusLost

    private void jComboBox1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jComboBox1FocusGained
        // TODO add your handling code here:
         jComboBox1.setBackground(Color.yellow);
    }//GEN-LAST:event_jComboBox1FocusGained

    private void jComboBox1FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jComboBox1FocusLost
        // TODO add your handling code here:
         jComboBox1.setBackground(Color.white);
    }//GEN-LAST:event_jComboBox1FocusLost

    private void jButton2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton2FocusGained
        // TODO add your handling code here:
         jButton2.setBackground(Color.yellow);
    }//GEN-LAST:event_jButton2FocusGained

    private void jButton2FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton2FocusLost
        // TODO add your handling code here:
         jButton2.setBackground(Color.white);
    }//GEN-LAST:event_jButton2FocusLost

    private void jButton4FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton4FocusGained
        // TODO add your handling code here:
        jButton4.setBackground(Color.yellow);
    }//GEN-LAST:event_jButton4FocusGained

    private void jButton4FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton4FocusLost
        // TODO add your handling code here:
         jButton4.setBackground(Color.white);
    }//GEN-LAST:event_jButton4FocusLost

    private void jButton5FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton5FocusGained
        // TODO add your handling code here:
         jButton5.setBackground(Color.yellow);
    }//GEN-LAST:event_jButton5FocusGained

    private void jButton5FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton5FocusLost
        // TODO add your handling code here:
         jButton5.setBackground(Color.white);
    }//GEN-LAST:event_jButton5FocusLost

    private void jButton3FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton3FocusGained
        // TODO add your handling code here:
         jButton3.setBackground(Color.yellow);
    }//GEN-LAST:event_jButton3FocusGained

    private void jButton3FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton3FocusLost
        // TODO add your handling code here:
         jButton3.setBackground(Color.white);
    }//GEN-LAST:event_jButton3FocusLost


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JComboBox jComboBox1;
    private javax.swing.JComboBox jComboBox2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextField jTextField1;
    // End of variables declaration//GEN-END:variables
javax.swing.table.DefaultTableModel dtm;
private void loadChallanNo()
{
    dtm.setRowCount(0);
    try
    {
     
        //interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
       interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}

        String qry="Select cashier_number from cashier_detail order by cashier_number";
        String load[]=object1.getResultSetAs_1D_Array(qry,Main.year);
        if(load!=null)
        {
            jComboBox1.addItem("Select");
            for(int i=0;i<load.length;i++)
            {
                jComboBox1.addItem(load[i]);
            }
        }
        qry="Select dp_name from department_detail order by dp_code";
        load=object1.getResultSetAs_1D_Array(qry,Main.year);
        if(load.length>0)
        {
            for(int i=0;i<load.length;i++)
            {
                jComboBox2.addItem(load[i]);
            }
        }


      //  String d1[]=jLabel2.getText().split("-");
      //  String setDate=d1[2]+"-"+d1[1]+"-"+d1[0];
        ////////////for challan sheet no/////////////

      /*  qry="Select cashier_code from cashier_detail where cashier_number="+Integer.parseInt(""+jComboBox1.getSelectedItem())+"";
        String getCode=object1.getSigetngleValue(qry, Main.year);
      
        qry="Select max(challansheet_no) from challan_detail";
        String getChallanNo1=object1.getSigetngleValue(qry,Main.year);
        if(getChallanNo1.length()>0)
        {
            int challanNo=Integer.parseInt(getChallanNo1)+1;
            jTextField1.setText(""+challanNo);
        }
        if(getChallanNo1.length()==0)
        {
            qry="Select max(challansheet_no) from challansheetno";
            String getChallanNo=object1.getSigetngleValue(qry,Main.year);
            int challanNo=Integer.parseInt(getChallanNo)+1;
            jTextField1.setText(""+challanNo);
        }*/
         //////for amount calculation///////////////
       /* qry="Select amount from build_distribution where edate='"+setDate+"' and cashier_code="+Integer.parseInt(getCode);
        String amount=object1.getSigetngleValue(qry, year);
        System.out.println("amount........."+amount);
        //double amt=Double.valueOf(amount);
        jLabel7.setText(""+(new java.math.BigDecimal(Double.valueOf(amount)).setScale(3,java.math.BigDecimal.ROUND_HALF_UP)));
        qry="Select amount from build_distribution where amounttype='"+"Cheque"+"'and edate='"+setDate+"' and cashier_code="+Integer.parseInt(getCode);
        String cheque=object1.getSigetngleValue(qry, year);
        System.out.println("cheque........."+cheque);
        jLabel9.setText(""+(new java.math.BigDecimal(Double.valueOf(cheque)).setScale(3,java.math.BigDecimal.ROUND_HALF_UP)));
        //jLabel11.setText(""+new java.math.BigDecimal(Double.valueOf(0)).setScale(2,java.math.BigDecimal.ROUND_HALF_UP));
        dueAmount();

        ////////////for user challan no/////////////
        int ind=0;
        qry="Select challan_code from challan_detail where cashier_code="+Integer.parseInt(getCode)+"";
        System.out.println("qry............."+qry);
        String getChallan=object1.getSigetngleValue(qry, year);
        System.out.println("getChallan......."+getChallan);
        System.out.println("getChallan.len......"+getChallan.length());
        if(getChallan==null || getChallan.length()==0)
        {
            ind=1;
            jLabel6.setText(""+ind);
            
        }
       if(getChallan.length()>0)
        {
            ind=Integer.parseInt(getChallan)+1;
            jLabel6.setText(""+ind);
        }

        ///////////for user's challan detail//////////
        qry="Select challan_no,edate from challan_detail where edate='"+setDate+"' and cashier_code="+Integer.parseInt(getCode)+"";
        String upload[][]=object1.getInformationDD(qry,2,year);
        if(upload!=null)
        {
            String arr[]=new String[3];
            int index=0;
            for(int i=0;i<upload.length;i++)
            {
                arr[0]=""+(++index);
                arr[1]=upload[i][0];
                arr[2]=upload[i][1];
                dtm.addRow(arr);
            }
        }
        double tot=(Double.valueOf(jLabel7.getText())+Double.valueOf(jLabel11.getText()))-Double.valueOf(jLabel9.getText());
        System.out.println("tot........."+tot);
        jLabel13.setText(""+new java.math.BigDecimal(tot).setScale(2,java.math.BigDecimal.ROUND_HALF_UP));
        */

    }
    catch(Exception e)
    {
        System.out.println("Error ! In loadChallanNo Method."+e);
    }
}
private boolean save()
{
    try
    {
        //interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
       interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}
        if(jTextField1.getText().trim().equals(""))
        {
            javax.swing.JOptionPane.showMessageDialog(null,"Please input challan book sheet no.");
            jTextField1.requestFocus();
            return false;
        }
        if(object1.isInteger(jTextField1.getText().trim())==false)
        {
              javax.swing.JOptionPane.showMessageDialog(null,"Plaese input number type(Challan book sheet no.) value only.");
              jTextField1.requestFocus();
              return false;
        }
        printDataNew PD=new printDataNew();
        String d1[]=jLabel2.getText().split("-");
        String setDate=d1[2]+"-"+d1[1]+"-"+d1[0];


        
        String qry="Select cashier_code from cashier_detail where cashier_number="+Integer.parseInt(""+jComboBox1.getSelectedItem())+"";
        String getCashierCode=object1.getSigetngleValue(qry, Main.year);
        qry="Select cashier_code from challan_detail where cashier_code="+Integer.parseInt(getCashierCode)+" and edate='"+setDate+"'";
        String getCashier=object1.getSigetngleValue(qry, Main.year);
        //////////////Changes carried out here there is unuseful dpcode ///////////////////
        //qry="Select dp_code from department_detail where dp_name='"+jComboBox2.getSelectedItem()+"'";
        qry="Select dp_code from department_detail where dp_name='"+"DFM"+"'";
        String getDpCode=object1.getSigetngleValue(qry,Main.year);

    
        if(getCashier.length()>0)
        {
            javax.swing.JOptionPane.showMessageDialog(null," Sorry ! Challan has been genereted already.");
        }
        else
        {         
            //qry="Select challansheet_no from challansheetno where challansheet_no="+Integer.parseInt(jTextField1.getText().trim())+" and dp_code="+Integer.parseInt(getDpCode);
            qry="Select challansheet_no from challan_detail where challansheet_no="+Integer.parseInt(jTextField1.getText().trim())+" and dp_code="+Integer.parseInt(getDpCode)+"";
            String getChallanNo=object1.getSigetngleValue(qry, Main.year);
            if(getChallanNo.length()==0)
            {
                String setDeadDate=2000+"-"+1+"-"+1;
                //qry="insert into challan_detail values("+Integer.parseInt(jTextField1.getText().trim())+","+Integer.parseInt(getCashierCode)+","+Integer.parseInt(jLabel6.getText())+",'"+setDate+"',"+Integer.parseInt(getDpCode)+","+"-1"+")";
                qry="insert into challan_detail values("+Integer.parseInt(jTextField1.getText().trim())+","+Integer.parseInt(getCashierCode)+","+Integer.parseInt(jLabel6.getText())+",'"+setDate+"',"+Integer.parseInt(getDpCode)+","+"-1"+",'"+setDeadDate+"',"+0+",-1,-1)";
                boolean bn=object1.saveInformation(qry, Main.year);
                if(bn)
                {
                    javax.swing.JOptionPane.showMessageDialog(null,"Process Completed.");
                    jTextField1.setText("");
                    jComboBox1.setSelectedIndex(0);
                    qry="Select max(challansheet_no) from challan_detail";
                    String getChallanNo1=object1.getSigetngleValue(qry,Main.year);
                    if(getChallanNo1.equals("-1")==false)
                    {
                        int challanNo=Integer.parseInt(getChallanNo1)+1;
                        jTextField1.setText(""+challanNo);
                    }
                    jLabel7.setText("0.00");
                    jLabel9.setText("0.00");
                    jLabel11.setText("0.00");
                    jLabel13.setText("0.00");
                    jLabel17.setText("0.00");
                    jLabel6.setText("0");
                    jLabel6.setBackground(java.awt.Color.gray);
                    dtm.setRowCount(0);
                }
            }
            else
            {
                javax.swing.JOptionPane.showMessageDialog(null,"This Challan sheet no. already exists");
                jTextField1.requestFocus();
            }
        }
    }
    catch(Exception e)
    {
        System.out.println("Error ! In Save Method."+e);
    }
return true;
}
private void corresspondingChallan()
{
    //javax.swing.JOptionPane.showMessageDialog(this, "ok");
    dtm.setRowCount(0);
    jLabel7.setText("0.00");
    jLabel9.setText("0.00");
    jLabel11.setText("0.00");
    jLabel13.setText("0.00");
    jLabel17.setText("0.00");
    try
    {
        //interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
       interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}
        String d1[]=jLabel2.getText().split("-");
        String setDate=d1[2]+"-"+d1[1]+"-"+d1[0];
        String deadDate=2000+"-"+1+"-"+1;

        String qry="Select cashier_code from cashier_detail where cashier_number='"+(""+jComboBox1.getSelectedItem())+"'";
        String getCode=object1.getSigetngleValue(qry, Main.year);
        qry="select max(challan_no) from challan_detail where cashier_code="+Integer.parseInt(getCode);
        String getChallan[]=object1.getResultSetAs_1D_Array(qry,Main.year);
        int ind=0;
        if(getChallan[0]==null)
        {
            //ind=1;
            qry="Select challan_no from opening_challan_no where cashier_code="+Integer.parseInt(getCode);
            String getLastChallan=object1.getSigetngleValue(qry,Main.year);
            ///ind=Integer.parseInt(getLastChallan)+1;
            ind=Integer.parseInt(getLastChallan);
            jLabel6.setText(""+ind);
            jLabel6.setBackground(java.awt.Color.GREEN);
        }
        else if(getChallan[0]!=null)// || getChallan.length>0)
        {
            ind=Integer.parseInt(getChallan[0])+1;
            jLabel6.setText(""+ind);
            jLabel6.setBackground(java.awt.Color.GREEN);

            qry="Select challan_no from challan_detail where cashier_code="+Integer.parseInt(getCode)+" and edate='"+setDate+"'";
            String getChallanno=object1.getSigetngleValue(qry, Main.year);
            if(getChallanno!=null)
            {
                if (getChallanno.equals("") == false)
                {
                    jLabel6.setText(""+getChallanno);
                    jLabel6.setBackground(java.awt.Color.RED);
                }
            }

        }
         
       // dueAmount();
        ////////calculation of due amount///////
        double receivedamount=0.00,amount=0.00,dueAmount=0.00,returningAmt=0.0,lastYearDue=0.0,todaysreceivedAmount=0;
        qry="Select dueamount from opening_dueamount where cashier_code="+Integer.parseInt(getCode)+"";
        String dueAmt=object1.getSigetngleValue(qry,Main.year);
        if(dueAmt.length()>0)// || dueAmt.length>0)
            dueAmount=Double.valueOf(dueAmt);
        else
            dueAmount=0.0;

      //  javax.swing.JOptionPane.showMessageDialog(null,"Coming.....due......"+dueAmt[0]+dueAmt[0].length());
        //qry="Select sum(amount) from build_distribution where cashier_code="+Integer.parseInt(getCode)+" and amounttype='"+"Cash"+"'and (edate<='"+setDate+"' and edate>='"+setDate+"')";
        //qry="Select sum(amount) from build_distribution where cashier_code="+Integer.parseInt(getCode)+" and amounttype='"+"Cash"+"'and (edate<='"+setDate+"'   and '"+setDate+"'<=edate)";

        ///////sum of amount/////////////////////
       // qry="Select sum(amount) from build_distribution where cashier_code="+Integer.parseInt(getCode)+" and edate<'"+setDate+"' and (amounttype='"+"Cash"+"' and amounttype='"+"Cash n Cheque"+"')";
         qry="Select sum(amount) from build_distribution where cashier_code="+Integer.parseInt(getCode)+" and edate<'"+setDate+"'";
        String amt[]=object1.getResultSetAs_1D_Array(qry,Main.year);
     //   System.out.println("amt...4545..."+amt+"   5656..."+amt.length);
        if(amt[0]!=null )//|| amt.length>0)
            amount=Double.valueOf(amt[0]);
        else
            amount=0.0;
        //////sum of received amount///////////////
        qry="Select sum(received_amount) from received_cash_detail where cashier_code="+Integer.parseInt(getCode)+" and  edate<'"+setDate+"'";
        String receivedAmt[]=object1.getResultSetAs_1D_Array(qry,Main.year);
        if(receivedAmt[0]!=null)// || receivedAmt.length>0)
            receivedamount=Double.valueOf(receivedAmt[0]);
        else
            receivedamount=0.0;



        //double totalDueAmt=(dueAmount+amount)-receivedamount;
       /* lastYearDue=backDateCalculation(getCode);
        System.out.println("lastYearDue..........."+lastYearDue);*/


        double totalDueAmt=dueAmount+amount;
        //if(totalDueAmt>=receivedamount)
            totalDueAmt=totalDueAmt-receivedamount;
      
        /////////////returning dues of closed challan/////////////////
        qry="Select edate from challan_detail where edate<'"+setDate+"' and cashier_code="+Integer.parseInt(getCode)+" and closing_status="+"1"+" order by edate asc";
        String loadDate[]=object1.getResultSetAs_1D_Array(qry,Main.year);
        if(loadDate!=null && loadDate.length>0)
        {
            for(int i=0;i<loadDate.length;i++)
            {
                String D1[]=loadDate[i].split("-");
                String matchDate=D1[2]+"-"+D1[1]+"-"+D1[0];
                //qry="Select sum(amount) from build_distribution where edate='"+matchDate+"' and paymentdate='"+deadDate+"' and cashier_code="+Integer.parseInt(getCode)+") and (amounttype='"+"Cash"+"'  and amounttype='"+"Cash n Cheque"+"')";
                qry="Select sum(amount) from build_distribution where edate='"+matchDate+"' and paymentdate='"+deadDate+"' and cashier_code="+Integer.parseInt(getCode)+"";
                String getReturningAmount=object1.getSigetngleValue(qry,Main.year);
                if(getReturningAmount!=null)
                {
                    returningAmt=returningAmt+Double.valueOf(getReturningAmount);
                }
               
            }

        }

        /////////////////////////////////////////////////////////////

        //if(totalDueAmt>=returningAmt)
            totalDueAmt=totalDueAmt-returningAmt;
     


        jLabel11.setText(""+new java.math.BigDecimal(totalDueAmt).setScale(2,java.math.BigDecimal.ROUND_HALF_UP));
        
        /////////////////////////////////////////
        //////amount calculation/////////////////
        double totAmt=0.0,totcheque=0.0;
        //qry="Select sum(amount) from build_distribution where edate='"+setDate+"' and cashier_code="+Integer.parseInt(getCode);
        qry="Select sum(mix_amount) from build_distribution where edate='"+setDate+"' and cashier_code="+Integer.parseInt(getCode);
        String amt1[]=object1.getResultSetAs_1D_Array(qry,Main.year);
        if(amt1[0]!=null)// || amt.length>0)
             totAmt=Double.valueOf(amt1[0]);
        else //if(amt==null)
             totAmt=0.0;

        jLabel7.setText(""+(new java.math.BigDecimal(totAmt).setScale(2,java.math.BigDecimal.ROUND_HALF_UP)));
        
        //GET ALL CHECK AMOUNT
        qry="Select distinct(bill_Code) from build_distribution where cashier_code="+Integer.parseInt(getCode)+" and edate='"+setDate+"'";
        String load[]=object1.getResultSetAs_1D_Array(qry,Main.year);
        if(load!=null)
        {
            for(int i=0;i<load.length;i++)
            {
                //qry="Select sum(chq_amt) from cheque_details where bill_code="+Integer.parseInt(load[i]);
                qry="Select sum(chq_Amt) from build_distribution where bill_code="+Integer.parseInt(load[i]);
                String cheque=object1.getSigetngleValue(qry,Main.year);
                if(cheque!=null)// || totcheque.length>0)
                totcheque=totcheque+Double.valueOf(cheque);
                
            }
            
        }
        jLabel9.setText(""+(new java.math.BigDecimal(totcheque).setScale(2,java.math.BigDecimal.ROUND_HALF_UP)));

        qry="Select received_amount from received_cash_detail where cashier_code="+Integer.parseInt(getCode)+" and edate='"+setDate+"'";
        String getTodaysReceivedAmount[]=object1.getResultSetAs_1D_Array(qry,Main.year);
        System.out.println("getTodaysReceivedAmount............"+getTodaysReceivedAmount);
        if(getTodaysReceivedAmount!=null && getTodaysReceivedAmount.length>0)// || getTodaysReceivedAmount.equals("")==false)
        {
            todaysreceivedAmount=Double.valueOf(getTodaysReceivedAmount[0]);
        }
        System.out.println("todaysreceivedAmount..........."+todaysreceivedAmount);
        jLabel17.setText(""+new java.math.BigDecimal(todaysreceivedAmount).setScale(2, java.math.BigDecimal.ROUND_HALF_UP));
        double totalAmount=(totAmt-totcheque)+totalDueAmt;
       // if(totalAmount>=todaysreceivedAmount)
        totalAmount=totalAmount-todaysreceivedAmount;
        /*else
            totalAmount=0.00;*/
        jLabel13.setText(""+new java.math.BigDecimal(totalAmount).setScale(2, java.math.BigDecimal.ROUND_HALF_UP));


        String data[][]=object1.getInformationDD("select pmrno,co7,co6,mix_amount,amounttype,dp_code,partyname from build_distribution where edate='"+setDate+"' and cashier_code="+Integer.parseInt(getCode), 7, Main.year);
        dtm.setRowCount(0);
        String arr[];
        //System.out.println("c:"+Main.year);
        if(data!=null)
        for(int r=0;r<data.length;r++)
        {
            arr=new String[8];
            arr[0]=""+(dtm.getRowCount()+1)+". ";
            //GET DP NAME
            String temparr[][]=object1.getInformationDD("select dp_name from department_detail where dp_code="+Integer.parseInt(data[r][5]),1,Main.year);
            arr[1]=temparr[0][0];
            
            arr[2]=data[r][0];  //pmr no
            arr[3]=data[r][1];  //co7
            arr[4]=data[r][2];  //co6
            arr[5]=""+(new java.math.BigDecimal(data[r][3])).setScale(2,5);  //amount
            arr[6]=data[r][4];  //cash or cheque
            arr[7]=data[r][6];
            dtm.addRow(arr);
        }

        /*qry="Select challan_no,edate from challan_detail where edate='"+setDate+"' and cashier_code="+Integer.parseInt(getCode)+"";
        String upload[][]=object1.getInformationDD(qry,2,Main.year);
        if(upload!=null)
        {
            String arr[]=new String[3];
            int index=0;
            String temp[];
            for(int i=0;i<upload.length;i++)
            {
                arr[0]=""+(++index)+".";
                arr[1]=upload[i][0];
                //arr[2]=upload[i][1];
                temp=upload[i][1].split("-");
                arr[2]=temp[2]+"-"+temp[1]+"-"+temp[0];
                dtm.addRow(arr);
            }
        }*/
    }
    catch(Exception e)
    {
        System.out.println("Error ! In correspondingChallan Method.678...."+e);
    }

}
private void uploadChallanBookSheetNo()
{
    try
    {
        //interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
       interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}
       ////////Changes carried out here to access challan sheet no.//////////////////
        String qry="Select dp_code from department_detail where dp_name='"+jComboBox2.getSelectedItem()+"'";
        String getDpCode=object1.getSigetngleValue(qry,Main.year);
        //qry="Select max(challansheet_no) from challan_detail where dp_code="+Integer.parseInt(getDpCode)+"";
        qry="Select max(challansheet_no) from challan_detail";
        String getChallanSheetNo[]=object1.getResultSetAs_1D_Array(qry,Main.year);
        
        //if(getChallanSheetNo.length()==0)
        if(getChallanSheetNo[0]==null)
        {
           // qry="Select challansheet_no from challansheetno where dp_code="+Integer.parseInt(getDpCode);
            qry="Select challansheet_no from challansheetno";
            String ChallanSheetno=object1.getSigetngleValue(qry,Main.year);
            if(ChallanSheetno.length()==0)
            {
                javax.swing.JOptionPane.showMessageDialog(null,"Error ! Please generate challan sheet no. first..");
                flag=false;
            }
            else if(ChallanSheetno.length()>0)
            {
                jTextField1.setText(ChallanSheetno);
                jTextField1.setBackground(Color.yellow);
                jTextField1.requestFocus();

            }
        }
        else if(getChallanSheetNo[0]!=null)
        {
             System.out.println("coming here..1234.............");
            int ind=Integer.parseInt(getChallanSheetNo[0])+1;
            jTextField1.setText(""+ind);
             jTextField1.setBackground(Color.yellow);
            jTextField1.requestFocus();
        }
    }
    catch(Exception e)
    {
        System.out.println("Error ! In uploadChallanBookSheetNo Method."+e);
    }

}
private void cancelChallan()
{
    try
    {
         interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}
        String d1[]=jLabel2.getText().split("-");
        String setDate=d1[2]+"-"+d1[1]+"-"+d1[0];
        String deadDate=2000+"-"+1+"-"+1;

        String qry="Select cashier_code from cashier_detail where cashier_number='"+(""+jComboBox1.getSelectedItem())+"'";
        String getCode=object1.getSigetngleValue(qry, Main.year);
        qry="select max(challan_no) from challan_detail where cashier_code="+Integer.parseInt(getCode)+"";
        String getMaxChallan=object1.getSigetngleValue(qry,Main.year);
        System.out.println("getMaxChallan........."+getMaxChallan);
        if(getMaxChallan!=null)
        {
            if(Integer.parseInt(jLabel6.getText())<Integer.parseInt(getMaxChallan))
            {
                 javax.swing.JOptionPane.showMessageDialog(null,"Sorry ! You can't cancel this challan.\nMay be this is not the last challan over here.");
            }
            if(Integer.parseInt(jLabel6.getText())==Integer.parseInt(getMaxChallan))
            {
             qry="Select challan_no from challan_detail where cashier_code="+Integer.parseInt(getCode)+" and edate='"+setDate+"' and challan_no="+Integer.parseInt(jLabel6.getText())+"";
             System.out.println("qry.........."+qry);
             String getChallanno=object1.getSigetngleValue(qry, Main.year);
             System.out.println("getChallanno........."+getChallanno);
             if(getChallanno.length()>0)
             {
                    qry="Select closing_status from challan_detail where cashier_code="+Integer.parseInt(getCode)+" and edate='"+setDate+"' and challan_no="+Integer.parseInt(jLabel6.getText())+"";
                    String status=object1.getSigetngleValue(qry,Main.year);
                    System.out.println("status......"+status);
                    if(status.equals("0")==true)
                    {
                        qry="select distinct(bill_Code) from  build_distribution where cashier_code="+Integer.parseInt(getCode)+" and edate='"+setDate+"' and status=1";
                        String getBillCode[]=object1.getResultSetAs_1D_Array(qry,Main.year);
                        System.out.println("getBillCode.........."+getBillCode.length);
                        if(getBillCode.length==0)
                        {
                            qry="delete from challan_detail where cashier_code="+Integer.parseInt(getCode)+" and edate='"+setDate+"'";
                            boolean bn=object1.saveInformation(qry,Main.year);
                            if(bn)
                            {
                                javax.swing.JOptionPane.showMessageDialog(null,"Process Completed.\nThis challan has been deleted successfully.");
                                jComboBox1.setSelectedIndex(0);
                                  jLabel7.setText("0.00");
                                  jLabel9.setText("0.00");
                                  jLabel11.setText("0.00");
                                  jLabel13.setText("0.00");
                                  jLabel17.setText("0.00");
                                  jLabel6.setText("0");
                                  jLabel6.setBackground(java.awt.Color.gray);
                                  dtm.setRowCount(0);
                            }
                        }
                        else
                        {
                            javax.swing.JOptionPane.showMessageDialog(null,"Sorry ! You can't cancel this challan.\nSome of the bills of this challan has been paid already.");
                        }

                    }
                    else if(status.equals("1")==true)
                    {
                        javax.swing.JOptionPane.showMessageDialog(null,"Sorry ! You can't cancel this challan.\nThis has been closed already.");
                    }
              }
             else
             {
                javax.swing.JOptionPane.showMessageDialog(null,"Sorry ! Before cancelling you have to generate this challan.\nMay be this challan no. has not been generated till now.");
             }


          }

        }
        





    }
    catch(Exception e)
    {
        System.out.println("Error ! In cancelChallan Method."+e);
    }

}
public class printDataNew {

        java.io.PrintWriter pw;

        public printDataNew() {


            try {
                System.out.println("inside printing...");
                String space = "";
                String temp = "";
                int rep = 0;
                int row = 0, maxrows = 65;
                System.out.println("Start printing");
                java.io.FileOutputStream fos1 = null;
                try {
                    fos1=new java.io.FileOutputStream("LPT1");
                     //fos1=new java.io.FileOutputStream("Challan.in");

                    //fos1 = new java.io.FileOutputStream("test.in");//LPT1");
                    System.out.println("inside find port...LPT1");

                } catch (Exception ex) {
                    System.out.println("port not found...");
                    fos1=new java.io.FileOutputStream("Challan.in");//LPT1");

                }
                pw = new java.io.PrintWriter(fos1);
                //row++;
                String str4 = "EASTERN RAILWAYS";
                //pw.println();
                //row++;
                pw.println("                               " + str4);
                row ++;//= 5;

                pw.println();
                row++;
                pw.println(" " + "The Dist Pay Clerck No........ " + jComboBox1.getSelectedItem() + "/" + jLabel6.getText() + "               Date : " + jLabel2.getText());
                row++;
                space="";
                String line="";
                for (int x = 1; x <=65; space += " ", x++);
                pw.println(space+line+ jTextField1.getText());

//               pw.println("                                                                                         " + jTextField1.getText());
                pw.println("-------------------------------------------------------------------------------------------------------");
                row++;
                 line = "";
                //javax.swing.JOptionPane.showMessageDialog(null, "A=" + space.length());
                //String temp="";
                 space="";
               // String total = "  Total Amount";
                temp="Total Amount";
                rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                line=temp+space;
                pw.print(line);
              //  pw.print(total);
                space="";
                line="";
               /* for (int x = 1; x <=8; space += " ", x++);
                //pw.print(space+line+jLabel13.getText());
                pw.print(space+line+jLabel7.getText());*/
                temp=jLabel7.getText();
                rep=16-temp.length();
                for(int x=0;x<rep;space+=" ",x++);
                line=space+temp;
                pw.print(line);
                pw.print(" ");
                space="";
                line="";
                String cheque="Cheque Amount";
                temp="Cheque Amount";
                rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=temp+space;
                pw.print(line);
               /* for (int x = 1; x <=6; space += " ", x++);
                pw.print(space+line+cheque);*/
                space="";
                line="";

               /* for (int x = 1; x <= 10; space += " ", x++);
                pw.println(space+line+jLabel9.getText());*/
                temp=jLabel9.getText();
                rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=space+temp;
                pw.println(line);
                row++;

                space = "";
               // line = "";

               /* pw.print("  Previous Amount");
                for (int i = 1; i <=5; space += " ", i++);*/
                temp="Previous Amount";
                rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=temp+space;
                pw.print(line);
                space="";
                temp=jLabel11.getText();
                rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=space+temp;
                pw.print(line);
               // pw.println(space + line + jLabel11.getText());
               ///  pw.print(space + line + jLabel11.getText());

                //double t=Double.valueOf(jLabel11.getText())+Double.valueOf(jLabel13.getText());
                 double t=Double.valueOf(jLabel7.getText())+Double.valueOf(jLabel11.getText());
                ///////////new field add Received cash on 17-07-2012
                 space="";
                 line="";
                 pw.print(" ");
                String receivedcash="Received Cash";
                temp="Received Cash";
                rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=temp+space;
                pw.print(line);
               /* for (int x = 1; x <= 6; space += " ", x++);
                pw.print(space+line+receivedcash);*/
                space="";
                line="";

                /*for (int x = 1; x <= 10; space += " ", x++);
                pw.println(space+line+jLabel17.getText());*/
                temp=jLabel17.getText();
                rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=space+temp;
                pw.println(line);
                row++;




                ////////////////////////////////////////////////////
                //pw.print("  Total");
                space="";
                temp="Total";
                rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=temp+space;
                pw.print(line);
                space="";
                line="";
                temp=""+new java.math.BigDecimal(t).setScale(2,5);
                rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=space+temp;
                pw.print(line);

                //Generate a line
                space="";
                line="                 ----------------";
                temp="";
                pw.println(line);

                //end code
                row++;
               /* for (int x = 1; x <= 15; space += " ", x++);
                pw.println(space+line+temp);*/

               space="";
               line="";
               //pw.print("  Less Remitance");
               temp="Less Remitance";
               rep=16-temp.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=temp+space;
                pw.print(line);
                space="";
               // for (int x = 1; x <= 6; space += " ", x++);
                //pw.println(space + line + jLabel9.getText());
               ///////////total  cash n cheque must be displayed here/////////
               double tot=Double.valueOf(jLabel9.getText())+Double.valueOf(jLabel17.getText());
               String temp1=""+new java.math.BigDecimal(tot).setScale(2,5);
               rep=16-temp1.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=space+temp1;
               pw.print(line);


               //code to print sum of
               //cheque amt + cash amt
               space="";
               java.math.BigDecimal bd1=new java.math.BigDecimal(jLabel9.getText());
               bd1=bd1.add(new java.math.BigDecimal(jLabel17.getText()));
               bd1=bd1.setScale(2,5);
               temp1=""+bd1;
               rep=33-temp1.length();
                for(int x=0;x<=rep;space+=" ",x++)
                    line=space+temp1;
               pw.println(line);

               row++;
              // pw.println(space + line + temp1);

               ////////////////////////////////////////////////////////
                //pw.print("  Balance Due");
               temp="Balance Due";
               rep=16-temp.length();
                space="";
               line="";
                for(int x=0;x<=rep;space+=" ",x++)
                    line=temp+space;
               pw.print(line);
               // for (int x = 1; x <= 9; space += " ", x++);
                //double r=t-Double.valueOf(jLabel11.getText());
               double r=t-tot;
               String tempt=(""+new java.math.BigDecimal(r).setScale(2,5));
               System.out.println("tempt..........."+tempt);
               space="";
               temp=tempt;
               rep=16-temp.length();
               for(int x=0;x<=rep;space+=" ",x++)
                    line=space+temp;
               pw.println(line);
               row++;
              //  pw.println(space + line + tempt);


                pw.println("-------------------------------------------------------------------------------------------------------");
pw.println();
//pw.println(" Pro No  A.V.No C.O.7No P.C.No   Cash       Cheque.        No.    Total             ");
pw.println(" PMR No    CO7No     CO6No     Bill Type         Cash          Party Name          Cheque. No.    Total");
                pw.println("-------------------------------------------------------------------------------------------------------");


               // pw.println("Cheque Amount");
            try
            {
                //interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
               interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}        
                        double temptot=0;
                        int rep1=10;
                        for(int i=0;i<dtm.getRowCount();i++)
                        {
                            //pw.print(" "+str2[i][0]);
                            ////////Pmr no
                            //String temp2=data[i][0];
                            pw.print("");
                            String temp2=""+jTable1.getValueAt(i,2);
                            rep1=9-temp2.length();
                            space="";
                            for(int x = 0; x <=rep1; space +=" ", x++);
                            line=temp2+space;
                            pw.print(line);
                                           
                            ////////CO7
                           // temp2=data[i][1];
                            space="";
                            temp2=""+jTable1.getValueAt(i,3);
                            rep1=10-temp2.length();
                            //System.out.println("rep1......."+rep1);
                            //for (int x = 1; x <=28; space += " ", x++);
                            for(int x = 0; x<=rep1; space+=" ", x++);
                            line=temp2+space;
                            pw.print(line);
                            space="";
                            ///////CO6

                            //temp2=data[i][2];
                            temp2=""+jTable1.getValueAt(i,4);
                            rep1=9-temp2.length();
                            for (int x = 0; x <=rep1; space +=" ", x++);
                            line=temp2+space;
                            pw.print(line);
                            pw.print(" ");
                            space="";
                            ///////Bill type
                            //temp2=data[i][4];
                            pw.print(" ");
                            temp2=""+jTable1.getValueAt(i,6);
                            rep1=14-temp2.length();
                            System.out.println("rep1..23..."+rep1);
                            for (int x = 0; x <=rep1; space +=" ", x++);
                            line=temp2+space;
                            pw.print(line);
                            space="";
                            ///////Amount
                            
                            //temp2=data[i][3];
                            temp2=""+jTable1.getValueAt(i, 5);
                            rep1=12-temp2.length();
                            temptot=temptot+Double.valueOf(""+jTable1.getValueAt(i,5));
                            for (int x = 0; x <=rep1; space +=" ", x++);
                            line=space + temp2;
                            pw.print(line);


                             pw.print(" ");
                              pw.print(" ");
                            space="";
                            temp2=""+jTable1.getValueAt(i,7);
                            if(temp2.length()>20)
                               temp2=temp2.substring(0,20);
                          
                            rep1=20-temp2.length();
                            System.out.println("rep1..23..."+rep1);
                            for (int x = 0; x <=rep1; space +=" ", x++);
                            line=temp2+space;
                            pw.println(line);

                                                       
                            //pw.println(space + line + str2[i][1]);
                            row++;

                        }
                //    }
                    space="";
                    line="";
                    // for (int x = 1; x <= 30; space += " ", x++);
                     for (int x = 1; x <= 48; space += " ", x++);
                     pw.println(space +"--------------");
                     row++;
                     space="";
                    line="";
                    temp=""+new java.math.BigDecimal(temptot).setScale(2,5);
                    for(int x = 1; x <= 61-temp.length(); space += " ", x++);
                     pw.println(space+temp);

                     row++;
                     space="";
                     //for (int x = 1; x <= 51; space += " ", x++);
                     //pw.println(space +"---------------");
                pw.println("-------------------------------------------------------------------------------------------------------");
                     row++;
                     space="";
                    line="";
// }


                   //  pw.println(space + line + str5);

                    pw.println();
                    row++;
                    pw.println("Received bills as detailed in F.A.No................ together with case Rs.....");
                    row++;
                    pw.println();
                    row++;
                    pw.println("...........................and Cheque Rs.......................................");
                    row++;
                    pw.println();
                    row++;
                    pw.print("Station....................");

                    space="";
                    line="";
                            for (int x = 1; x <= 27; space += " ", x++);
                            pw.println(space + line + "Pay Clerck No............");
                            row++;
                            for(int i=0;i>6;i++)
                            {
                                pw.println();
                                row++;
                            }
               //  }


            }
            catch(Exception ex)
            {
                javax.swing.JOptionPane.showMessageDialog(null,"Exception "+ex);
            }


                 scroll(maxrows-row);
                pw.close();
                fos1.close();


            } catch (Exception ex) {
                System.out.println("err..." + ex);
            }
        }
        public void scroll(int n)
        {
            for(int i=1;i<=n;i++)
            {
                pw.println();
            }
       }

    }
}
