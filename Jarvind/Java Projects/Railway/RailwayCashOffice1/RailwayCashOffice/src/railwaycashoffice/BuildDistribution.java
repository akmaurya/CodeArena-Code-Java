/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * BuildDistribution.java
 *
 * Created on Apr 18, 2012, 4:02:55 PM
 */

package railwaycashoffice;

import java.awt.Color;
import java.math.BigInteger;

/**
 *
 * @author pratiksha
 */
public class BuildDistribution extends javax.swing.JInternalFrame {

    /** Creates new form BuildDistribution */
    public BuildDistribution() {
        initComponents();
        java.util.Date dt=new java.util.Date();
        int date=dt.getDate();
        int month=dt.getMonth()+1;
        int yr=dt.getYear()+1900;
        String setDate=date+"-"+month+"-"+yr;
        jLabel9.setText(setDate);
        jTextField1.setText("");
        jTextField2.setText("");
        
        jTextField4.setText("");
        jTextField5.setText("");


        jTable1.setAutoResizeMode(jTable1.AUTO_RESIZE_OFF);
        dtm=new javax.swing.table.DefaultTableModel();
        javax.swing.table.DefaultTableCellRenderer CRLeft = new javax.swing.table.DefaultTableCellRenderer();
        javax.swing.table.DefaultTableCellRenderer CRRight = new javax.swing.table.DefaultTableCellRenderer();
        javax.swing.table.DefaultTableCellRenderer CRCenter = new javax.swing.table.DefaultTableCellRenderer();
        CRLeft.setHorizontalAlignment(javax.swing.JLabel.LEFT);
        CRRight.setHorizontalAlignment(javax.swing.JLabel.RIGHT);
        CRCenter.setHorizontalAlignment(javax.swing.JLabel.CENTER);
        javax.swing.table.TableColumn column;
        String heading1[]={"Sr. No.","PMR No.","CO7","CO6","Cashier No.","Party Name","Amount","Bill Type"};
        dtm=new javax.swing.table.DefaultTableModel(heading1,0);
        jTable1.setModel(dtm);
            column=jTable1.getColumn("Sr. No.");
            column.setCellRenderer(CRRight);
            column.setPreferredWidth(50);
            column=jTable1.getColumn("PMR No.");
            column.setCellRenderer(CRCenter);
            column.setPreferredWidth(60);
            column=jTable1.getColumn("CO7");
            column.setCellRenderer(CRCenter);
            column.setPreferredWidth(60);
            column=jTable1.getColumn("CO6");
            column.setCellRenderer(CRCenter);
            column.setPreferredWidth(60);
            column=jTable1.getColumn("Cashier No.");
            column.setCellRenderer(CRRight);
            column.setPreferredWidth(80);
            column=jTable1.getColumn("Party Name");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(150);
            column=jTable1.getColumn("Amount");
            column.setCellRenderer(CRRight);
            column.setPreferredWidth(100);
            column=jTable1.getColumn("Bill Type");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(80);
            loadInitialInfo();
   //         jButton1.requestFocus();

            jTable1.setRowHeight(30);

            setData();
            jComboBox1.requestFocus();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jTextField1 = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jTextField2 = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jTextField4 = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        jTextField5 = new javax.swing.JTextField();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jComboBox2 = new javax.swing.JComboBox();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jComboBox3 = new javax.swing.JComboBox();
        jLabel1 = new javax.swing.JLabel();
        jComboBox1 = new javax.swing.JComboBox();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();

        setClosable(true);
        setIconifiable(true);
        setTitle("BILL DISTRIBUTION TO CASHIER");
        getContentPane().setLayout(null);

        jPanel1.setBackground(new java.awt.Color(129, 178, 219));
        jPanel1.setLayout(null);

        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel2.setText("PMR No.");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(10, 20, 90, 20);

        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel4.setText("CO7");
        jPanel1.add(jLabel4);
        jLabel4.setBounds(10, 60, 90, 20);

        jLabel5.setBackground(new java.awt.Color(204, 255, 255));
        jLabel5.setFont(new java.awt.Font("Tahoma", 0, 12));
        jLabel5.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel5.setText("0");
        jLabel5.setOpaque(true);
        jPanel1.add(jLabel5);
        jLabel5.setBounds(90, 10, 130, 25);

        jTextField1.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jTextField1.setText("jTextField1");
        jTextField1.setToolTipText("Please input CO7 number");
        jTextField1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField1ActionPerformed(evt);
            }
        });
        jTextField1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jTextField1FocusGained(evt);
            }
        });
        jTextField1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextField1KeyPressed(evt);
            }
        });
        jPanel1.add(jTextField1);
        jTextField1.setBounds(90, 60, 130, 25);

        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel3.setText("CO6");
        jPanel1.add(jLabel3);
        jLabel3.setBounds(10, 110, 90, 20);

        jTextField2.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jTextField2.setText("jTextField2");
        jTextField2.setToolTipText("Please input CO6 number");
        jTextField2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField2ActionPerformed(evt);
            }
        });
        jTextField2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jTextField2FocusGained(evt);
            }
        });
        jTextField2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextField2KeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                jTextField2KeyTyped(evt);
            }
        });
        jPanel1.add(jTextField2);
        jTextField2.setBounds(90, 110, 130, 25);

        jLabel6.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel6.setText("Cashier No.");
        jPanel1.add(jLabel6);
        jLabel6.setBounds(10, 160, 90, 20);

        jLabel7.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel7.setText("Party Name");
        jPanel1.add(jLabel7);
        jLabel7.setBounds(10, 210, 90, 20);

        jTextField4.setText("jTextField4");
        jTextField4.setToolTipText("Please input party name");
        jTextField4.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextField4KeyPressed(evt);
            }
        });
        jPanel1.add(jTextField4);
        jTextField4.setBounds(90, 210, 130, 27);

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel10.setText("Amount");
        jPanel1.add(jLabel10);
        jLabel10.setBounds(10, 260, 90, 20);

        jTextField5.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jTextField5.setText("jTextField5");
        jTextField5.setToolTipText("Please input amount");
        jTextField5.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextField5KeyPressed(evt);
            }
        });
        jPanel1.add(jTextField5);
        jTextField5.setBounds(90, 260, 130, 25);

        jButton2.setMnemonic('c');
        jButton2.setText("Close");
        jButton2.setToolTipText("Close");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        jButton2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jButton2FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jButton2FocusLost(evt);
            }
        });
        jButton2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton2KeyPressed(evt);
            }
        });
        jPanel1.add(jButton2);
        jButton2.setBounds(440, 350, 400, 30);

        jButton3.setMnemonic('s');
        jButton3.setText("Save");
        jButton3.setToolTipText("Save Information");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });
        jButton3.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jButton3FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jButton3FocusLost(evt);
            }
        });
        jButton3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton3KeyPressed(evt);
            }
        });
        jPanel1.add(jButton3);
        jButton3.setBounds(30, 350, 380, 30);

        jComboBox2.setToolTipText("Please select amount type");
        jComboBox2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jComboBox2FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jComboBox2FocusLost(evt);
            }
        });
        jComboBox2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jComboBox2KeyPressed(evt);
            }
        });
        jPanel1.add(jComboBox2);
        jComboBox2.setBounds(90, 285, 130, 25);

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane1.setViewportView(jTable1);

        jPanel1.add(jScrollPane1);
        jScrollPane1.setBounds(230, 20, 630, 300);

        jComboBox3.setToolTipText("Please select cashier  number");
        jComboBox3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jComboBox3KeyPressed(evt);
            }
        });
        jPanel1.add(jComboBox3);
        jComboBox3.setBounds(90, 160, 130, 25);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(20, 80, 870, 400);

        jLabel1.setBackground(new java.awt.Color(156, 163, 119));
        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 11));
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("Select Department");
        jLabel1.setOpaque(true);
        getContentPane().add(jLabel1);
        jLabel1.setBounds(350, 30, 190, 25);

        jComboBox1.setForeground(new java.awt.Color(0, 0, 255));
        jComboBox1.setToolTipText("Please select department");
        jComboBox1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox1ActionPerformed(evt);
            }
        });
        jComboBox1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jComboBox1FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                jComboBox1FocusLost(evt);
            }
        });
        jComboBox1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jComboBox1KeyPressed(evt);
            }
        });
        getContentPane().add(jComboBox1);
        jComboBox1.setBounds(540, 30, 350, 26);

        jLabel8.setBackground(new java.awt.Color(156, 163, 119));
        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 11));
        jLabel8.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel8.setText("Date");
        jLabel8.setOpaque(true);
        getContentPane().add(jLabel8);
        jLabel8.setBounds(20, 30, 70, 25);

        jLabel9.setBackground(new java.awt.Color(255, 255, 204));
        jLabel9.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel9.setText("jLabel9");
        jLabel9.setOpaque(true);
        getContentPane().add(jLabel9);
        jLabel9.setBounds(90, 30, 190, 25);

        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/railwaycashoffice/images/calendar.png"))); // NOI18N
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        jButton1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton1KeyPressed(evt);
            }
        });
        getContentPane().add(jButton1);
        jButton1.setBounds(280, 30, 30, 25);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jTextField2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField2ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jTextField2ActionPerformed

    private void jTextField1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jTextField1ActionPerformed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        // TODO add your handling code here:
     if(jComboBox3.getSelectedItem().equals("Select"))
     {
            javax.swing.JOptionPane.showMessageDialog(null,"Error ! Please select the cashier no. from the list");
            jComboBox3.requestFocus();
     }
     else
     {
            Save();
     }
              
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
           Cal date1=new Cal();
           jLabel9.setText(date1.getdate());
           jComboBox1.requestFocus();
            loadPMR();
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jComboBox1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox1ActionPerformed
        // TODO add your handling code here:
      //  javax.swing.JOptionPane.showMessageDialog(null,"coming here first.....");
        loadPMR();
        setData();
    }//GEN-LAST:event_jComboBox1ActionPerformed

    private void jTextField2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField2KeyPressed
        // TODO add your handling code here:
      if(evt.getKeyCode()==10)
      {
          jComboBox3.requestFocus();
      }
    }//GEN-LAST:event_jTextField2KeyPressed

    private void jTextField2KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField2KeyTyped
        // TODO add your handling code here:
    //    lastLoad();
    }//GEN-LAST:event_jTextField2KeyTyped

    private void jButton1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
              Cal date1=new Cal();
           jLabel9.setText(date1.getdate());
        }
    }//GEN-LAST:event_jButton1KeyPressed

    private void jComboBox1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jComboBox1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
            jTextField1.requestFocus();
        }
    }//GEN-LAST:event_jComboBox1KeyPressed

    private void jTextField1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
            jTextField2.requestFocus();
        }
    }//GEN-LAST:event_jTextField1KeyPressed

    private void jTextField4KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField4KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
            jTextField5.requestFocus();
        }
    }//GEN-LAST:event_jTextField4KeyPressed

    private void jTextField5KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField5KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
            jComboBox2.requestFocus();
        }
    }//GEN-LAST:event_jTextField5KeyPressed

    private void jComboBox2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jComboBox2KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
            jButton3.requestFocus();
        }
    }//GEN-LAST:event_jComboBox2KeyPressed

    private void jButton3KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton3KeyPressed
        // TODO add your handling code here:
          if(evt.getKeyCode()==10)
          {
             if(jComboBox3.getSelectedItem().equals("Select"))
             {
                javax.swing.JOptionPane.showMessageDialog(null,"Error ! Please select the cashier no. from the list");
                jComboBox3.requestFocus();
             }
             else
             {
                Save();
             }
        }
 
    }//GEN-LAST:event_jButton3KeyPressed

    private void jButton3FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton3FocusGained
        // TODO add your handling code here:
        jButton3.setForeground(Color.red);
    }//GEN-LAST:event_jButton3FocusGained

    private void jButton3FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton3FocusLost
        // TODO add your handling code here:
        jButton3.setForeground(Color.black);

    }//GEN-LAST:event_jButton3FocusLost

    private void jButton2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton2FocusGained
        // TODO add your handling code here:
        jButton2.setForeground(Color.red);

    }//GEN-LAST:event_jButton2FocusGained

    private void jButton2FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jButton2FocusLost
        // TODO add your handling code here:
        jButton2.setForeground(Color.black);

    }//GEN-LAST:event_jButton2FocusLost

    private void jComboBox3KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jComboBox3KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
            jTextField4.requestFocus();
}//GEN-LAST:event_jComboBox3KeyPressed

    private void jComboBox2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jComboBox2FocusGained
        // TODO add your handling code here:
        jComboBox2.setForeground(Color.red);
    }//GEN-LAST:event_jComboBox2FocusGained

    private void jComboBox2FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jComboBox2FocusLost
        // TODO add your handling code here:
        jComboBox2.setForeground(Color.black);
    }//GEN-LAST:event_jComboBox2FocusLost

    private void jComboBox1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jComboBox1FocusGained
        // TODO add your handling code here:
        jComboBox1.setForeground(Color.red);
    }//GEN-LAST:event_jComboBox1FocusGained

    private void jComboBox1FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jComboBox1FocusLost
        // TODO add your handling code here:
        jComboBox1.setForeground(Color.black);
    }//GEN-LAST:event_jComboBox1FocusLost

    private void jTextField1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jTextField1FocusGained
        // TODO add your handling code here:
        jTextField1.selectAll();
    }//GEN-LAST:event_jTextField1FocusGained

    private void jTextField2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jTextField2FocusGained
        // TODO add your handling code here:
        jTextField2.selectAll();
    }//GEN-LAST:event_jTextField2FocusGained

    private void jButton2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton2KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
            this.dispose();
    }//GEN-LAST:event_jButton2KeyPressed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JComboBox jComboBox1;
    private javax.swing.JComboBox jComboBox2;
    private javax.swing.JComboBox jComboBox3;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JTextField jTextField4;
    private javax.swing.JTextField jTextField5;
    // End of variables declaration//GEN-END:variables
javax.swing.table.DefaultTableModel dtm;
private void loadInitialInfo()
{
    try
    {
        //interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
             interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}
        String qry="Select cashtype from cash_type";

        String load[]=object1.getResultSetAs_1D_Array(qry,Main.year);
        if(load!=null && load.length>0)
        {
            //jComboBox2.removeAllItems();
            for(int i=0;i<load.length;i++)
            {
                    jComboBox2.addItem(load[i]);
            }

        }
        qry="Select dp_name from department_detail order by dp_code";
        load=object1.getResultSetAs_1D_Array(qry,Main.year);

        if(load!=null && load.length>0)
        {
            for(int i=0;i<load.length;i++)
            {
                jComboBox1.addItem(load[i]);
            }
        }

         qry="Select cashier_number from cashier_detail order by cashier_number";
         load=object1.getResultSetAs_1D_Array(qry,Main.year);
        System.out.println("load len..........."+load.length);
        if(load!=null)
        {
            jComboBox3.addItem("Select");
            for(int i=0;i<load.length;i++)
            {
                jComboBox3.addItem(load[i]);
            }
        }




    }
    catch(Exception e)
    {
        System.out.println("Error ! In loadInitialInfo Method."+e);
    }

}
private void loadPMR()
{
    int ind=1;
    jLabel5.setText("");
    jTextField1.setText("");
    try
    {
       
        //interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
             interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}
        String qry="Select dp_code from department_detail where dp_name='"+(""+jComboBox1.getSelectedItem())+"'";
        String getDpCode=object1.getSigetngleValue(qry,Main.year);
      
        String getStr[]=jLabel9.getText().split("-");
        String setDate=getStr[2]+"-"+getStr[1]+"-"+getStr[0];
        String dummydate=getStr[2]+"-"+getStr[1]+"-"+1;
        
        int chkDt=Integer.parseInt(getStr[0]);
        String getpmr=null;
        if(chkDt==1)
        {
            qry="Select max(pmrno) from build_distribution where dp_code="+Integer.parseInt(getDpCode)+" and edate='"+setDate+"'";
            getpmr=object1.getSigetngleValue(qry,Main.year);
            if(getpmr==null)
            {
                jLabel5.setText("1");

            }
        }
        else
        {
                qry="Select max(pmrno) from build_distribution where dp_code="+Integer.parseInt(getDpCode)+" and (edate>='"+dummydate+"' and edate<='"+setDate+"')";
                getpmr=object1.getSigetngleValue(qry,Main.year);
                if(getpmr==null)
                {
                    jLabel5.setText("1");

                }
                else// if(getpmr.length() > 0)
                {
                    ind=Integer.parseInt(getpmr)+1;
                    jLabel5.setText(""+ind);
                }
        }

        
          
        //javax.swing.JOptionPane.showMessageDialog(null,"coming here.........");
        //if(getpmr.length()==0)
        
        /*else if(getpmr.length() > 0)
        {
            ind=Integer.parseInt(getpmr)+1;
            jLabel5.setText(""+ind);
            

        }*/


        qry="Select max(CO6) from build_distribution where dp_code="+Integer.parseInt(getDpCode);
        System.out.println("qry......"+qry);
        String getCO6=object1.getSigetngleValue(qry,Main.year);
        if(getCO6!=null)
        {
        int temp=Integer.parseInt(getCO6)+1;
        jTextField2.setText(""+temp);
        }
        else
        {
                jTextField2.setText("1");
        }
        //jTextField2.setText(getCO6);

       
    }
    catch(Exception e)
    {
        System.out.println("Error ! In loadPMR Method."+e);
    }

}
private boolean Save()
{

     try
     {
             //interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
             interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}

   if(jTextField1.getText().trim().equals(""))
   {

            javax.swing.JOptionPane.showMessageDialog(null,"Please input CO7 number.");
            jTextField1.requestFocus();
            return false;
   }
  
    if(jTextField2.getText().trim().equals(""))
    {
            javax.swing.JOptionPane.showMessageDialog(null,"Please input CO6 number.");
            jTextField2.requestFocus();
            return false;
    }
   
     if(jTextField4.getText().trim().equals(""))
     {
     
            javax.swing.JOptionPane.showMessageDialog(null,"Please input party name.");
            jTextField4.requestFocus();
            return false;
     }
     if(jTextField5.getText().trim().equals(""))
     {
            javax.swing.JOptionPane.showMessageDialog(null,"Please input amount.");
            jTextField5.requestFocus();
            return false;
     }
    
     if(object1.isDouble(jTextField5.getText())==false)
     {
             javax.swing.JOptionPane.showMessageDialog(null,"Error ! Please input number type(Amount) value");
              jTextField5.requestFocus();
             return false;
     }
     if(object1.isInteger(jTextField1.getText())==false)
     {
         javax.swing.JOptionPane.showMessageDialog(null,"Error ! Please input number type(CO7) value");
          jTextField1.requestFocus();
         return false;
     }
     if(object1.isInteger(jTextField2.getText())==false)
     {
          javax.swing.JOptionPane.showMessageDialog(null,"Error ! Please input number type(CO6) value");
           jTextField1.requestFocus();
          return false;
     }

     ///////////amount field will hold cash n cheque,cash amount And mix_amount field will hold total amount wheather it's cash or cheque
    
     String qry="Select dp_code from department_detail where dp_name='"+(""+jComboBox1.getSelectedItem())+"'";
     String getDpCode=object1.getSigetngleValue(qry, Main.year);
     String getStr[]=jLabel9.getText().split("-");
     String setDate=getStr[2]+"-"+getStr[1]+"-"+getStr[0];
     qry="Select CO6 from build_distribution where dp_code="+Integer.parseInt(getDpCode);
     String CO6=object1.getSigetngleValue(qry, Main.year);
     qry="Select cashier_code from cashier_detail where cashier_number="+Integer.parseInt(""+jComboBox3.getSelectedItem())+"";
     String getCashierCode=object1.getSigetngleValue(qry, Main.year);
     int Flag=0;
     String setDeadDate=2000+"-"+1+"-"+1;
     int bill_no=0;
     double mixamount=0,totAmount=0;
     qry="Select max(bill_Code) from build_distribution";
     String getBillno=object1.getSigetngleValue(qry, Main.year);
     if(getBillno!=null)
          bill_no=Integer.parseInt(getBillno)+1;
     else
          bill_no=1;

     mixamount=Double.valueOf(jTextField5.getText());
     if((jComboBox2.getSelectedItem().equals("Cash n Cheque")==true) ||(jComboBox2.getSelectedItem().equals("Cash")==true))
         totAmount=Double.valueOf(jTextField5.getText());
     else
         totAmount=0;


     if(CO6.length()==0)
     {
       
            //qry="insert into build_distribution values("+Integer.parseInt(getDpCode)+",'"+setDate+"',"+Integer.parseInt(jLabel5.getText())+","+Integer.parseInt(jTextField1.getText())+","+Integer.parseInt(jTextField2.getText())+","+Integer.parseInt(getCashierCode)+",'"+jTextField4.getText().trim().toString()+"',"+Double.valueOf(jTextField5.getText())+",'"+(""+jComboBox2.getSelectedItem())+"',"+0+",'"+setDeadDate+"',"+0+",'"+setDeadDate+"')";

            qry="insert into build_distribution values("+bill_no+","+Integer.parseInt(getDpCode)+",'"+setDate+"',"+Integer.parseInt(jLabel5.getText())+",'"+jTextField1.getText()+"',"+Integer.parseInt(jTextField2.getText())+","+Integer.parseInt(getCashierCode)+",'"+jTextField4.getText().trim().toString()+"',"+totAmount+",'"+(""+jComboBox2.getSelectedItem())+"',"+0+",'"+setDeadDate+"',"+mixamount+")";
            object1.saveInformation(qry,Main.year);
            Flag=1;
            //return bn;
     }
     else if(Integer.parseInt(CO6) != Integer.parseInt(jTextField2.getText().trim()))
     {
       
         //   qry="insert into build_distribution values("+Integer.parseInt(getDpCode)+",'"+setDate+"',"+Integer.parseInt(jLabel5.getText())+","+Integer.parseInt(jTextField1.getText())+","+Integer.parseInt(jTextField2.getText())+","+Integer.parseInt(getCashierCode)+",'"+jTextField4.getText().trim().toString()+"',"+Double.valueOf(jTextField5.getText())+",'"+(""+jComboBox2.getSelectedItem())+"',"+0+",'"+setDeadDate+"',"+0+",'"+setDeadDate+"')";
            //qry="insert into build_distribution values("+Integer.parseInt(getDpCode)+",'"+setDate+"',"+Integer.parseInt(jLabel5.getText())+","+Integer.parseInt(jTextField1.getText())+","+Integer.parseInt(jTextField2.getText())+","+Integer.parseInt(getCashierCode)+",'"+jTextField4.getText().trim().toString()+"',"+Double.valueOf(jTextField5.getText())+",'"+(""+jComboBox2.getSelectedItem())+"',"+0+",'"+setDeadDate+"')";
         qry="insert into build_distribution values("+bill_no+","+Integer.parseInt(getDpCode)+",'"+setDate+"',"+Integer.parseInt(jLabel5.getText())+",'"+jTextField1.getText()+"',"+Integer.parseInt(jTextField2.getText())+","+Integer.parseInt(getCashierCode)+",'"+jTextField4.getText().trim().toString()+"',"+totAmount+",'"+(""+jComboBox2.getSelectedItem())+"',"+0+",'"+setDeadDate+"',"+mixamount+")";
            object1.saveInformation(qry,Main.year);
           // return bn;
            Flag=1;

     }
     else
     {
            javax.swing.JOptionPane.showMessageDialog(null,"Error! This CO6 number already exists.");
            jTextField2.requestFocus();
            return false;

     }
   // System.out.println("value of.............bn.."+bn);
    // javax.swing.JOptionPane.showMessageDialog(null,"values of bn........."+bn);
     if(Flag==1)
     {
                javax.swing.JOptionPane.showMessageDialog(null,"Process Completed");
                int index=dtm.getRowCount();
                String arr[]=new String[8];

                arr[0]=""+(++index)+". ";
                arr[1]=jLabel5.getText();
                arr[2]=jTextField1.getText();
                arr[3]=jTextField2.getText();
                arr[4]=""+jComboBox3.getSelectedItem();
                arr[5]=jTextField4.getText();
                arr[6]=""+(new java.math.BigDecimal(jTextField5.getText())).setScale(2,5);
                arr[7]=""+jComboBox2.getSelectedItem();
                dtm.addRow(arr);

                jTextField2.setText("");
                jComboBox3.setSelectedIndex(0);
                jTextField4.setText("");
                jTextField5.setText("");
                jComboBox2.setSelectedIndex(0);


                  getStr=jLabel9.getText().split("-");
                  setDate=getStr[2]+"-"+getStr[1]+"-"+getStr[0];
                  String dummydate=getStr[2]+"-"+getStr[1]+"-"+1;

                 //// int chkDt=Integer.parseInt(getStr[0]);
                  String getpmr=null;

                 qry="Select max(pmrno) from build_distribution where dp_code="+Integer.parseInt(getDpCode)+" and (edate>='"+dummydate+"' and edate<='"+setDate+"')";
                 getpmr=object1.getSigetngleValue(qry,Main.year);
                 if(getpmr.length() > 0)
                 {
                    int ind=Integer.parseInt(getpmr)+1;
                    jLabel5.setText(""+ind);
                 }

               /* qry="Select max(pmrno) from build_distribution where dp_code="+Integer.parseInt(getDpCode);
                String getpmr=object1.getSigetngleValue(qry, Main.year);
                if(getpmr==null)
                {
                    jLabel5.setText("1");
                }
                
                else if(getpmr.length() > 0)
                {
                    Integer ind=0;
                    ind=Integer.parseInt(getpmr)+1;
                    jLabel5.setText(""+ind);

                }*/
                qry="Select max(CO6) from build_distribution where dp_code="+Integer.parseInt(getDpCode);
                String getCO6=object1.getSigetngleValue(qry, Main.year);
                int temp=Integer.parseInt(getCO6)+1;
                jTextField2.setText(""+temp);

                jTextField1.requestFocus();
      }



    }
     catch(Exception e)
     {
         System.out.println("Error ! In Save Method."+e);
     }

   return true;
}
/*private void lastLoad()
{
   
    try
    {
        String getT=Main.MR.getTitle();
        String f1[]=getT.split(":");
        String f2[]=f1[1].split("-");
        String year=f2[0]+f2[1];
        year=year.trim();
        interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
        String qry="Select dp_code from department_detail where dp_name='"+(""+jComboBox1.getSelectedItem())+"'";
        String getDpCode=object1.getSigetngleValue(qry, year);
        System.out.println("dpcode........."+getDpCode);
        qry="Select max(CO6) from build_distribution where dp_code="+Integer.parseInt(getDpCode);
        String getCO6=object1.getSigetngleValue(qry, year);
        System.out.println("getCO6................"+getCO6);
        int temp=Integer.parseInt(getCO6)+1;
        jTextField2.setText(""+temp);
        //jTextField2.setText(getCO6);

    }
    catch(Exception e)
    {
        System.out.println("Error ! In lastLoad Method."+e);
    }

}*/


private void setData()
{
    try
    {

        //interfaceRailway object1=(interfaceRailway)java.rmi.Naming.lookup("rmi://127.0.0.1/railwayMethods");
             interfaceRailway object1=null;
		try
		{
			object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
		}
		catch(Exception e)
		{
				System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
				getIPaddress.changeIP();
				try
				{
					object1=(interfaceRailway)java.rmi.Naming.lookup(getIPaddress.IP());
				}
				catch(Exception ex)
				{
					System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/railwayMethods  ..."+ex);
				}
		}        
        String qry="Select dp_code from department_detail where dp_name='"+(""+jComboBox1.getSelectedItem())+"'";
        String getDpCode=object1.getSigetngleValue(qry,Main.year);
        //System.out.println("a");
        String getStr[]=jLabel9.getText().split("-");
        String setDate=getStr[2]+"-"+getStr[1]+"-"+getStr[0];

        //System.out.println("b:"+"select pmrno,co7,co6,cashier_code,party_name,amount,amounttype from build_distribution where edate='"+setDate+"' and dp_code="+Integer.parseInt(getDpCode));
        String data[][]=object1.getInformationDD("select pmrno,co7,co6,cashier_code,partyname,amount,amounttype from build_distribution where edate='"+setDate+"' and dp_code="+Integer.parseInt(getDpCode), 7, Main.year);
        dtm.setRowCount(0);
        String arr[];
        //System.out.println("c:"+Main.year);
        if(data!=null)
        for(int r=0;r<data.length;r++)
        {
            arr=new String[8];
            arr[0]=""+(dtm.getRowCount()+1)+". ";
            arr[1]=data[r][0];  //pmr no
            arr[2]=data[r][1];  //co7
            arr[3]=data[r][2];  //co6
            arr[4]=data[r][3];  //cashier code

            arr[5]=data[r][4];  //party name
            arr[6]=""+(new java.math.BigDecimal(data[r][5])).setScale(2,5);  //amount
            arr[7]=data[r][6];  //cash or cheque

            //get cashier no with help of cashier code
            arr[4]=object1.getSigetngleValue("select cashier_number from cashier_detail where cashier_code="+Integer.parseInt(data[r][3]), Main.year);

            dtm.addRow(arr);
        }
    }
    catch(Exception ex)
    {
        System.out.println("error 290..."+ex);
    }
}
}
