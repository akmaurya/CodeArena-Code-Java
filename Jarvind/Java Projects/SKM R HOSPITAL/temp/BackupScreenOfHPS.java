/*
 *This form is designed in NetBeans Software
 *
 * BackupScreen.java
 *
 * Created on December 7, 2010, 3:56 PM
 */

/**
 *
 * @author  Sunil
 */
 import java.rmi.*;
public class BackupScreenOfHPS extends javax.swing.JInternalFrame implements Runnable{
    
    /** Creates new form BackupScreen */
    public BackupScreenOfHPS(javax.swing.JDesktopPane jDesktopPane1) {
        initComponents();
        
        java.awt.Dimension dm=java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        reshape((dm.width-534)/2,(dm.height-300)/2,534,210);
        jDesktopPane1.add(this);
        setVisible(true);
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
    	
        jButton1 = new javax.swing.JButton(new javax.swing.ImageIcon("icons\\dbrecord32.gif"));
        jLabel1 = new javax.swing.JLabel();
        jProgressBar1 = new javax.swing.JProgressBar();
		setClosable(true);
		setTitle("Backup Window");
        getContentPane().setLayout(null);

        jButton1.setText("G E T   B A C K U P");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        getContentPane().add(jButton1);
        jButton1.setBounds(21, 20, 480, 50);

        jLabel1.setFont(new java.awt.Font("Arial", 0, 10));
        jLabel1.setText("Please wait...");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(20, 110, 90, 13);

        jProgressBar1.setForeground(new java.awt.Color(255, 51, 51));
        jProgressBar1.setStringPainted(true);
        getContentPane().add(jProgressBar1);
        jProgressBar1.setBounds(20, 130, 480, 18);

        pack();
    }// </editor-fold>//GEN-END:initComponents

     private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
// TODO add your handling code here:
		t1=new Thread(this,"Demo");
		t1.start();
        takeBackup();
    }//GEN-LAST:event_jButton1ActionPerformed
    public void run()
    {
    	ZedInterface inf=null;
    	try
    	{
    		//ZedInterface obj1=(ZedInterface)Naming.lookup(getIPaddress.IP());
    		
    		
 	try
							{
								inf=(ZedInterface)Naming.lookup(getIPaddress.IP());
				
				
							}
							catch(Exception e)
							{
									System.out.println("Error at the time of connection with server "+getIPaddress.IP()+"..."+e);
							
									try
									{
										inf=(ZedInterface)Naming.lookup("rmi://127.0.0.1/ExtendZedServer");
											
										
									}
									catch(Exception ex)
									{
										System.out.println("Error at the time of connection with server ip-rmi//127.0.0.1/ExtendZedServer  ..."+ex);
									}
							}		   		
    		
    		
    		msg=inf.getBackupOfDatabase();
    	}
    	catch(Exception e)
    	{
    		System.out.println("error........."+e);
    	}
    }
    private void takeBackup()
    {
        try
        {
            pb=new progressBar1();
            pb.start();
        }
        catch(Exception ex)
        {
            System.out.println("error no. 9291..."+ex);
        }
    }
    class progressBar1 extends Thread
    {
                public void run()
                {
                    try
                    {
                           jLabel1.setVisible(true);
                           jProgressBar1.setVisible(true);
                           jButton1.setEnabled(false);
                           int i=1;
							while(i<=100)
							{
					    		jProgressBar1.setValue(i);
					    		if(i==50)
					    		{
					    			while(t1.isAlive()){}
					    			i=80;
					    		}   
                         		Thread.sleep(10);
                         		i++;
                    		}
                    		
                    		javax.swing.JOptionPane.showMessageDialog(null,msg,"Congratulation !",javax.swing.JOptionPane.INFORMATION_MESSAGE);
                    		dispose();    
                    }
                    catch(Exception ex)
                    {
                        System.out.println("error....skmR...984..."+ex);
                    }
                }
    }    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JProgressBar jProgressBar1;
    String msg="";
    Thread t1;
    progressBar1 pb;
    // End of variables declaration//GEN-END:variables
    
}
