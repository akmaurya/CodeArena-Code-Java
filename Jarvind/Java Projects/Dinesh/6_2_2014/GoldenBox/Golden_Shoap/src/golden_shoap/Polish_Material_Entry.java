/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * Polish_Material_Entry.java
 *
 * Created on Jan 9, 2014, 11:47:31 AM
 */

package golden_shoap;

/**
 *
 * @author user1
 */
public class Polish_Material_Entry extends javax.swing.JInternalFrame {
  javax.swing.table.DefaultTableModel dtm;
    /** Creates new form Polish_Material_Entry */
    public Polish_Material_Entry() {
        initComponents();

         dtm=new javax.swing.table.DefaultTableModel();
            javax.swing.table.DefaultTableCellRenderer CRLeft = new javax.swing.table.DefaultTableCellRenderer();
            javax.swing.table.DefaultTableCellRenderer CRRight = new javax.swing.table.DefaultTableCellRenderer();
            javax.swing.table.DefaultTableCellRenderer CRCenter = new javax.swing.table.DefaultTableCellRenderer();
            CRLeft.setHorizontalAlignment(javax.swing.JLabel.LEFT);
            CRRight.setHorizontalAlignment(javax.swing.JLabel.RIGHT);
            CRCenter.setHorizontalAlignment(javax.swing.JLabel.CENTER);
            javax.swing.table.TableColumn column;
            String heading1[]={"S.No","Material Name","Material Unit"};
            dtm=new javax.swing.table.DefaultTableModel(heading1,0);
            jTable1.setModel(dtm);
            column=jTable1.getColumn("S.No");
            column.setCellRenderer(CRCenter);
            column.setPreferredWidth(8);

            column=jTable1.getColumn("Material Name");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(200);

            column=jTable1.getColumn("Material Unit");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(100);

            //set material in material unit combo Box
                      Utility.makeConnection();
                      String qry="select * from polish_material_unit"  ;
                      String[][] data=Utility.getInformationDD(qry,1);
                      int length= data.length;
                      for(int i=0;i<length;i++)
                      {   jComboBox1.addItem(data[i][0]);
                      }
            //end
            loadItemsInTable();
             //"End load the table"


    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jTextField1 = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jComboBox1 = new javax.swing.JComboBox();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jLabel3 = new javax.swing.JLabel();

        setClosable(true);
        setIconifiable(true);
        setTitle("Polish Material");
        getContentPane().setLayout(null);

        jTextField1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField1ActionPerformed(evt);
            }
        });
        jTextField1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextField1KeyPressed(evt);
            }
        });
        getContentPane().add(jTextField1);
        jTextField1.setBounds(140, 10, 360, 30);

        jLabel1.setFont(new java.awt.Font("Tahoma", 0, 12));
        jLabel1.setText("Polish Material Name");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(10, 15, 120, 30);

        jLabel4.setFont(new java.awt.Font("Tahoma", 0, 12));
        jLabel4.setText("Material Unit");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(10, 60, 100, 30);

        jComboBox1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jComboBox1KeyPressed(evt);
            }
        });
        getContentPane().add(jComboBox1);
        jComboBox1.setBounds(140, 60, 110, 30);

        jButton1.setFont(new java.awt.Font("Verdana", 1, 14));
        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons/savefile.gif"))); // NOI18N
        jButton1.setMnemonic('a');
        jButton1.setText("Add");
        jButton1.setHorizontalAlignment(javax.swing.SwingConstants.LEADING);
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        jButton1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton1KeyPressed(evt);
            }
        });
        getContentPane().add(jButton1);
        jButton1.setBounds(10, 110, 110, 30);

        jButton2.setFont(new java.awt.Font("Verdana", 1, 14));
        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons/update.gif"))); // NOI18N
        jButton2.setMnemonic('u');
        jButton2.setText("Update");
        jButton2.setHorizontalAlignment(javax.swing.SwingConstants.LEADING);
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        jButton2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton2KeyPressed(evt);
            }
        });
        getContentPane().add(jButton2);
        jButton2.setBounds(130, 110, 120, 30);

        jButton3.setFont(new java.awt.Font("Verdana", 1, 14));
        jButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/delete.gif"))); // NOI18N
        jButton3.setMnemonic('d');
        jButton3.setText("Delete");
        jButton3.setHorizontalAlignment(javax.swing.SwingConstants.LEADING);
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });
        jButton3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton3KeyPressed(evt);
            }
        });
        getContentPane().add(jButton3);
        jButton3.setBounds(260, 110, 120, 30);

        jButton4.setFont(new java.awt.Font("Verdana", 1, 14));
        jButton4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/exit.gif"))); // NOI18N
        jButton4.setMnemonic('c');
        jButton4.setText("Close");
        jButton4.setHorizontalAlignment(javax.swing.SwingConstants.LEADING);
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        jButton4.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton4KeyPressed(evt);
            }
        });
        getContentPane().add(jButton4);
        jButton4.setBounds(390, 110, 110, 30);

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jTable1.setRowHeight(20);
        jTable1.setSelectionBackground(new java.awt.Color(255, 204, 255));
        jTable1.setSelectionForeground(new java.awt.Color(0, 0, 0));
        jTable1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable1MouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);

        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(10, 180, 490, 320);

        jLabel3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/DeskTopTextureEdit11.png"))); // NOI18N
        getContentPane().add(jLabel3);
        jLabel3.setBounds(0, 0, 520, 530);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jTextField1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField1ActionPerformed
        // TODO add your handling code here:
}//GEN-LAST:event_jTextField1ActionPerformed

    private void jTextField1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10) {
            jComboBox1.requestFocus();
        }
}//GEN-LAST:event_jTextField1KeyPressed

    private void jComboBox1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jComboBox1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10) {
            jButton1.requestFocus();
        }
    }//GEN-LAST:event_jComboBox1KeyPressed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        add();
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10) {
            add();

        }



    }//GEN-LAST:event_jButton1KeyPressed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:
        update();
}//GEN-LAST:event_jButton2ActionPerformed

    private void jButton2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton2KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10) {
            update();

        }
    }//GEN-LAST:event_jButton2KeyPressed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        delete();
}//GEN-LAST:event_jButton3ActionPerformed

    private void jButton3KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton3KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10) {
            delete();
        }
}//GEN-LAST:event_jButton3KeyPressed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_jButton4ActionPerformed

    private void jButton4KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton4KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10) {
            this.dispose();
        }

    }//GEN-LAST:event_jButton4KeyPressed

    private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable1MouseClicked
        // TODO add your handling code here:
        int selectedRow=jTable1.getSelectedRow();
        String itemName=""+jTable1.getValueAt(selectedRow,1);
        jTextField1.setText(itemName);
        jTextField1.requestFocus();
    }//GEN-LAST:event_jTable1MouseClicked


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JComboBox jComboBox1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextField jTextField1;
    // End of variables declaration//GEN-END:variables
  public void loadItemsInTable()
    {   dtm.setRowCount(0);
        String qry="select * from polish_material";
        String[][] data=Utility.getInformationDD(qry,2);
       int length= data.length;
       String arr[]=new String[3];
       for(int i=0;i<length;i++)
       {   arr[0]=""+(i+1);
           for(int j=0;j<2;j++)
           {
               arr[j+1]=data[i][j];
           }
           dtm.addRow(arr);
       }
    }
    public boolean add()
    {
        double quantity=0;
        double openingStock=0;
        int flag=0;
        String materialName=jTextField1.getText();
        materialName=materialName.trim();
        if(materialName.isEmpty())
        {
            javax.swing.JOptionPane.showMessageDialog(this,"Plese enter material name." ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
            jTextField1.requestFocus();
        }
        else
        {
              String qry="select material_name from polish_material";
              String[][] data=Utility.getInformationDD(qry,1);
              int length= data.length;
              for(int i=0;i<length;i++)
               {   if(data[i][0].equals(materialName))
                       {
                            flag=1;
                            break;
                       }
               }
           if(flag==0)
           {
            Utility.makeConnection();
            String qry1="insert into polish_material values('"+materialName.toUpperCase()+"','"+(jComboBox1.getSelectedItem())+"',"+quantity+","+openingStock+")";
            Utility.saveInformation(qry1);
            loadItemsInTable();
            jTextField1.requestFocus();
            jTextField1.setText("");
            }
            else
            {
                javax.swing.JOptionPane.showMessageDialog(this,"Material Name already exist." ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
                jTextField1.requestFocus();
            }
        }
        return true;
    }
    public boolean update()
    {
                        int flag=0;
                        Utility.makeConnection();
                        if(jTable1.getSelectedRow()!=(-1))
                        {
                        int selectedRow=jTable1.getSelectedRow();
                        String materialName=jTextField1.getText();
                        String selectedMaterialName=""+jTable1.getValueAt(selectedRow,1);
                        if(materialName.isEmpty())
                        {
                            javax.swing.JOptionPane.showMessageDialog(this,"Item name does not blank." ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
                            jTextField1.requestFocus();
                            jTextField1.setText(selectedMaterialName);

                        }
                        else
                        {            //to restrict duplicate entry start
                                     String qry1="select * from polish_material";
                                     String[][] data=Utility.getInformationDD(qry1,1);
                                      int length= data.length;
                                     for(int i=0;i<length;i++)
                                      {   if(data[i][0].equals(materialName))
                                          {
                                             flag=1;
                                             break;
                                           }
                                       }
                                     //End
                              if(flag==0)
                              {
                                 int check=javax.swing.JOptionPane.showConfirmDialog(this,"Are you sure to update materil name ?" ,"Confirm Window",javax.swing.JOptionPane.YES_NO_OPTION,javax.swing.JOptionPane.QUESTION_MESSAGE);
                                 if(check==javax.swing.JOptionPane.YES_OPTION)
                                 {    String qry="update polish_material set material_name='"+materialName.toUpperCase()+"', material_unit='"+(jComboBox1.getSelectedItem())+"' where material_name='"+selectedMaterialName+"'";
                                      System.out.println(qry);
                                   //   String qry2="update stock_master set item_name='"+itemName.toUpperCase()+"' where item_name='"+selectedItemName+"'";
                                      Utility.saveInformation(qry);
                                      //Utility.saveInformation(qry2);
                                      jTextField1.requestFocus();
                                      loadItemsInTable();
                                      jTextField1.setText("");
                                 }
                                 if(check==javax.swing.JOptionPane.NO_OPTION)
                                 {
                                      jTextField1.setText(selectedMaterialName);
                                 }
                              }
                              else
                              {
                                javax.swing.JOptionPane.showMessageDialog(this,"Error.... Material name already exist." ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
                                jTextField1.requestFocus();
                                jTextField1.setText(selectedMaterialName);

                              }
                        }
                     }
                 else
                    {
                         javax.swing.JOptionPane.showMessageDialog(this,"Please select row from the table. " ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
                         jTextField1.requestFocus();
                    }
        return true;
    }
    public boolean delete()
    {
        String materialName=jTextField1.getText();
        if(materialName.equalsIgnoreCase(""))
        {
            javax.swing.JOptionPane.showMessageDialog(this,"Plese select row from the table" ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
            jTextField1.requestFocus();
        }
        else
        {
             int flag=0;
             String qry1="select material_name from polish_material";
             String[][] data=Utility.getInformationDD(qry1,1);
             int length= data.length;
             for(int i=0;i<length;i++)
             {  if(data[i][0].equals(materialName))
                {
                   flag=1;
                   break;
                }
             }
            if(flag==1)
            {
                Utility.makeConnection();
                String qry="delete * from polish_material where material_name='"+materialName+"'";
                //String qry2="delete * from stock_master where item_name='"+itemName+"'";

                int check=javax.swing.JOptionPane.showConfirmDialog(this,"Are you sure to delete '"+materialName+"' record from the table ?" ,"Confirm Window",javax.swing.JOptionPane.YES_NO_OPTION,javax.swing.JOptionPane.QUESTION_MESSAGE);
                if(check==javax.swing.JOptionPane.YES_OPTION)
                {
                    Utility.saveInformation(qry);
                    //Utility.saveInformation(qry2);
                    loadItemsInTable();
                    jTextField1.setText("");
                    jTextField1.requestFocus();
                }
                if(check==javax.swing.JOptionPane.NO_OPTION)
                {
                    jTextField1.requestFocus();
                }
             }
            else
            {
                javax.swing.JOptionPane.showMessageDialog(this,"Material name does not exist. Please select from the table. " ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
                jTextField1.requestFocus();
            }
        }
        return true;
    }
}
