/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * Polished_Item_Return.java
 *
 * Created on Dec 11, 2013, 3:36:33 PM
 */

package golden_shoap;

import java.awt.Color;

/**
 *
 * @author user1
 */
public class Polished_Item_done extends javax.swing.JInternalFrame {
  javax.swing.table.DefaultTableModel dtm;
 static int purjaNumber;

    /** Creates new form Polished_Item_Return */
    public Polished_Item_done() {
        initComponents();

         dtm=new javax.swing.table.DefaultTableModel();
            javax.swing.table.DefaultTableCellRenderer CRLeft = new javax.swing.table.DefaultTableCellRenderer();
            javax.swing.table.DefaultTableCellRenderer CRRight = new javax.swing.table.DefaultTableCellRenderer();
            javax.swing.table.DefaultTableCellRenderer CRCenter = new javax.swing.table.DefaultTableCellRenderer();
            CRLeft.setHorizontalAlignment(javax.swing.JLabel.LEFT);
            CRRight.setHorizontalAlignment(javax.swing.JLabel.RIGHT);
            CRCenter.setHorizontalAlignment(javax.swing.JLabel.CENTER);
            javax.swing.table.TableColumn column;
            String heading1[]={"S.No","Customer Name","Purja Number","Work Status"};
            dtm=new javax.swing.table.DefaultTableModel(heading1,0);
            jTable1.setModel(dtm);
            column=jTable1.getColumn("S.No");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(30);

            column=jTable1.getColumn("Customer Name");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(180);

            column=jTable1.getColumn("Purja Number");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(80);

            column=jTable1.getColumn("Work Status");
            column.setCellRenderer(CRLeft);
            column.setPreferredWidth(80);
            loadData();

            


    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel4 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jLabel5 = new javax.swing.JLabel();
        jTextField1 = new javax.swing.JTextField();
        jButton3 = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jPanel5 = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jLabel12 = new javax.swing.JLabel();

        setBackground(new java.awt.Color(226, 252, 226));
        setClosable(true);
        setIconifiable(true);
        setTitle("Work Done");
        setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        getContentPane().setLayout(null);

        jPanel4.setBackground(new java.awt.Color(255, 255, 255));
        jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel4.setLayout(null);

        jPanel2.setBackground(new java.awt.Color(252, 251, 239));
        jPanel2.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jPanel2.setOpaque(false);
        jPanel2.setLayout(null);

        jLabel6.setFont(new java.awt.Font("Verdana", 1, 12));
        jLabel6.setText("Customer Name");
        jPanel2.add(jLabel6);
        jLabel6.setBounds(20, 10, 120, 30);

        jLabel1.setBackground(new java.awt.Color(235, 217, 254));
        jLabel1.setFont(new java.awt.Font("Tahoma", 0, 12));
        jLabel1.setOpaque(true);
        jPanel2.add(jLabel1);
        jLabel1.setBounds(20, 40, 200, 30);

        jLabel7.setFont(new java.awt.Font("Verdana", 1, 12));
        jLabel7.setText("Work Receiving Date");
        jPanel2.add(jLabel7);
        jLabel7.setBounds(20, 80, 140, 30);

        jLabel2.setBackground(new java.awt.Color(235, 217, 254));
        jLabel2.setFont(new java.awt.Font("Tahoma", 0, 12));
        jLabel2.setOpaque(true);
        jPanel2.add(jLabel2);
        jLabel2.setBounds(20, 110, 200, 30);

        jLabel8.setFont(new java.awt.Font("Verdana", 1, 12));
        jLabel8.setText("Purja Amount");
        jPanel2.add(jLabel8);
        jLabel8.setBounds(20, 150, 150, 30);

        jLabel3.setBackground(new java.awt.Color(235, 217, 254));
        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 12));
        jLabel3.setOpaque(true);
        jPanel2.add(jLabel3);
        jLabel3.setBounds(20, 180, 200, 30);

        jLabel9.setFont(new java.awt.Font("Verdana", 1, 12));
        jLabel9.setText("Total Due amount");
        jPanel2.add(jLabel9);
        jLabel9.setBounds(20, 220, 130, 30);

        jLabel4.setBackground(new java.awt.Color(235, 217, 254));
        jLabel4.setFont(new java.awt.Font("Tahoma", 0, 12));
        jLabel4.setOpaque(true);
        jPanel2.add(jLabel4);
        jLabel4.setBounds(20, 250, 200, 30);

        jLabel10.setFont(new java.awt.Font("Verdana", 1, 12));
        jLabel10.setText("Work Status");
        jPanel2.add(jLabel10);
        jLabel10.setBounds(20, 290, 130, 20);

        jLabel11.setBackground(new java.awt.Color(235, 217, 254));
        jLabel11.setFont(new java.awt.Font("Tahoma", 1, 14));
        jLabel11.setForeground(new java.awt.Color(0, 0, 153));
        jLabel11.setOpaque(true);
        jPanel2.add(jLabel11);
        jLabel11.setBounds(20, 310, 200, 30);

        jPanel4.add(jPanel2);
        jPanel2.setBounds(10, 100, 243, 350);

        jPanel3.setBackground(new java.awt.Color(252, 251, 239));
        jPanel3.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jPanel3.setOpaque(false);
        jPanel3.setLayout(null);

        jLabel5.setFont(new java.awt.Font("Verdana", 1, 12));
        jLabel5.setText("Enter Purja Number");
        jPanel3.add(jLabel5);
        jLabel5.setBounds(20, 0, 150, 40);

        jTextField1.setBackground(new java.awt.Color(255, 255, 153));
        jTextField1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextField1KeyPressed(evt);
            }
        });
        jPanel3.add(jTextField1);
        jTextField1.setBounds(20, 30, 170, 30);

        jButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons/show.gif"))); // NOI18N
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });
        jPanel3.add(jButton3);
        jButton3.setBounds(190, 30, 40, 30);

        jPanel4.add(jPanel3);
        jPanel3.setBounds(10, 10, 243, 80);

        jPanel1.setBackground(new java.awt.Color(238, 230, 205));
        jPanel1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jPanel1.setLayout(new java.awt.BorderLayout());

        jTable1.setFont(new java.awt.Font("Verdana", 0, 12));
        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jTable1.setRowHeight(20);
        jTable1.setSelectionBackground(new java.awt.Color(255, 204, 255));
        jTable1.setSelectionForeground(new java.awt.Color(0, 0, 0));
        jTable1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable1MouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);

        jPanel1.add(jScrollPane1, java.awt.BorderLayout.CENTER);

        jPanel4.add(jPanel1);
        jPanel1.setBounds(260, 10, 580, 560);

        jPanel5.setBackground(new java.awt.Color(252, 251, 239));
        jPanel5.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        jPanel5.setOpaque(false);
        jPanel5.setLayout(null);

        jButton1.setFont(new java.awt.Font("Verdana", 1, 12));
        jButton1.setMnemonic('p');
        jButton1.setText("Polish Finished");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        jButton1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton1KeyPressed(evt);
            }
        });
        jPanel5.add(jButton1);
        jButton1.setBounds(11, 20, 220, 30);

        jButton2.setFont(new java.awt.Font("Verdana", 1, 12));
        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/exit.gif"))); // NOI18N
        jButton2.setMnemonic('c');
        jButton2.setText("Close");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        jButton2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jButton2KeyPressed(evt);
            }
        });
        jPanel5.add(jButton2);
        jButton2.setBounds(11, 60, 220, 30);

        jPanel4.add(jPanel5);
        jPanel5.setBounds(10, 460, 243, 110);

        jLabel12.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/DeskTopTextureEdit.png"))); // NOI18N
        jPanel4.add(jLabel12);
        jLabel12.setBounds(0, 0, 870, 610);

        getContentPane().add(jPanel4);
        jPanel4.setBounds(0, 0, 850, 580);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable1MouseClicked
        // TODO add your handling code here:
        int selectedRow=jTable1.getSelectedRow();
        int purjaNumber=Integer.parseInt(""+jTable1.getValueAt(selectedRow,2));
        String customerName=""+jTable1.getValueAt(selectedRow,1);
        jLabel1.setText(customerName);
        String qry="select rec_date from polish_details where purja_number="+purjaNumber+"";
       // Coading for Date
       
       String date=""+Utility.getSingleValue(qry);
       String aa[]=new String[2];
       aa=date.split(" ");
       String bb=aa[0];
       String cc[]=new String[3];
       cc=bb.split("-");
       String sysDate=""+cc[2]+"-"+cc[1]+"-"+cc[0];
       //end
        //for Total amount
       String qry1="select amount from polish_details where purja_number="+purjaNumber+"";
       String[][] data=Utility.getInformationDD(qry1,1);
       double totalAmount=0;
       double amount=0;
       int length= data.length;
       for(int i=0;i<length;i++)
       {   amount=Double.valueOf(data[i][0]);
           totalAmount=totalAmount+amount;
       }
        
       //End
       jTextField1.setText(""+purjaNumber);
       jLabel2.setText(sysDate);
       java.math.BigDecimal bd=new java.math.BigDecimal(totalAmount);
       jLabel3.setText(""+bd.setScale(2,5));


       qry="select ac_code from ac_master where ac_name='"+customerName+"'";
       double accountCode=Double.valueOf(Utility.getSingleValue(qry));
       java.math.BigDecimal bd1=new java.math.BigDecimal(dueAmount(accountCode));
       jLabel4.setText(""+bd1.setScale(2,5));
       String temp=jTable1.getValueAt(jTable1.getSelectedRow(), 3).toString();
       System.out.println(temp);
       if(temp.equalsIgnoreCase("Polish Pending"))
       {          
           jLabel11.setForeground(Color.red);
             jLabel11.setText(temp);
        }
       if(temp.equalsIgnoreCase("Polish Done"))
       {
           jLabel11.setForeground(Color.BLUE);
             jLabel11.setText(temp);
        }

             
    }//GEN-LAST:event_jTable1MouseClicked

    private void jTextField1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField1KeyPressed
        // TODO add your handling code here:
       if(evt.getKeyCode()==10)
       {
         if(purjaNumberValidation()==1)
         {                  int purjaNumber=Integer.parseInt(""+jTextField1.getText());
                            String qry="select distinct ac_code from polish_details where purja_number="+purjaNumber+"";
                            int accountCode=Integer.parseInt(Utility.getSingleValue(qry));
                            qry="select ac_name from ac_master where ac_code="+accountCode+"";
                            String customerName=Utility.getSingleValue(qry);
                             // Coading for Date
                           qry="select rec_date from polish_details where purja_number="+purjaNumber+"";
                           String date=""+Utility.getSingleValue(qry);
                           String aa[]=new String[2];
                           aa=date.split(" ");
                           String bb=aa[0];
                           String cc[]=new String[3];
                             cc=bb.split("-");
                            String sysDate=""+cc[2]+"-"+cc[1]+"-"+cc[0];
                           //end
                            //for Total amount
                           String qry1="select amount from polish_details where purja_number="+purjaNumber+"";
                           String[][] data=Utility.getInformationDD(qry1,1);
                           double totalAmount=0;
                           double amount=0;
                           int length= data.length;
                           for(int i=0;i<length;i++)
                           {    amount=Double.valueOf(data[i][0]);
                               totalAmount=totalAmount+amount;
                           }
                           //End
                           jLabel1.setText(customerName);
                           jLabel2.setText(sysDate);
                           java.math.BigDecimal bd=new java.math.BigDecimal(totalAmount);
                           jLabel3.setText(""+bd.setScale(2,5));
                           java.math.BigDecimal bd1=new java.math.BigDecimal(dueAmount(accountCode));
                            jLabel4.setText(""+bd.setScale(2,5));
                           // jButton1.setEnabled(false);

                          // String temp=jTextF;
                           String work=null;
                if(purjaStatus()==0)
                {
                    work=" Polish Pending";
                    jLabel11.setForeground(Color.red);
                }
                if(purjaStatus()==1)
                {
                               work=" Polish Done";
                               jLabel11.setForeground(Color.BLUE);

                }
                if(purjaStatus()==2)
                {
                               work=" Finish";
                               jLabel11.setForeground(Color.DARK_GRAY);

                }
                jLabel11.setText(work);


         }
        else
         {    jTextField1.setText("");
              jLabel1.setText("");
              jLabel2.setText("");
              jLabel3.setText("");
              jLabel4.setText("");
              jLabel11.setText("");
              javax.swing.JOptionPane.showMessageDialog(this,"Invalied purja number." ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
             
         }
      }
    }//GEN-LAST:event_jTextField1KeyPressed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
       polishFinish();

    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        // TODO add your handling code here:
        if(Utility.isInteger(jTextField1.getText()))
        {
                                     int purjaNumber=Integer.parseInt(jTextField1.getText());
                                     int flag=0;
                                     String qry="select purja_number from polish_details where purja_number="+purjaNumber+"";
                                     String data[][]=Utility.getInformationDD(qry,1);
                                     for(int i=0;i<data.length;i++)
                                     {
                                         if((data[i][0]).equals(""+purjaNumber))
                                         {
                                             flag=1;
                                             break;
                                         }
                                     }


                        if(flag==1)
                        {
                        Purja_Detail ob=new  Purja_Detail((purjaNumber));
                        ob.setBounds(5,100,1020, 523);
                        Master_Screen.jDesktopPane1.add(ob);
                        ob.setVisible(true);
                        }
                        else
                        {
                              javax.swing.JOptionPane.showMessageDialog(this,"Error...Invalid purja number. " ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
                        }
        }
        else
        {
              javax.swing.JOptionPane.showMessageDialog(this,"Error...Invalid purja number. " ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
        }

    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButton1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton1KeyPressed
        // TODO add your handling code here:
        if(evt.getKeyCode()==10)
        {
              polishFinish();
        }
            
    }//GEN-LAST:event_jButton1KeyPressed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:
        this.dispose();
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jButton2KeyPressed
        // TODO add your handling code here:
      if(evt.getKeyCode()==10)
      {
        this.dispose();
      }
    }//GEN-LAST:event_jButton2KeyPressed
//To check purja number exist or not.
public int purjaNumberValidation()
{
       int purjaNumber=Integer.parseInt(""+jTextField1.getText());
       String qry1="select purja_number from polish_details";
       String[][] data=Utility.getInformationDD(qry1,1);
       int tablePurjaNumber;
       int valid=0;
       int length= data.length;
       for(int i=0;i<length;i++)
       {   tablePurjaNumber=Integer.parseInt(data[i][0]);
           if(tablePurjaNumber==purjaNumber)
           {   valid=1;
           }

       }
    return valid;


}

public double dueAmount(double accountCode)
        {
               String qry1="select ac_dr,ac_cr from ac_smry where ac_code="+accountCode+"";
                           System.out.println(qry1);
                           String[][] data=Utility.getInformationDD(qry1,2);
                           double acDr=Double.valueOf(data[0][0]);
                           double acCr=Double.valueOf(data[0][1]);
                           Double dueAmount=acDr-acCr;
                           java.math.BigDecimal bd=new java.math.BigDecimal(dueAmount);
                           dueAmount=Double.valueOf((""+bd.setScale(2,5)));
                           return dueAmount;
       }
public void polishFinish()
{
        int purjaNumber=Integer.parseInt(""+jTextField1.getText());
        int status=1;
        try
        {
        if(purjaNumber>0)
        {
           if(purjaNumberValidation()==1)
           {
             String qry="update polish_details set status="+status+" where purja_number="+purjaNumber+"";
             boolean bn=Utility.saveInformation(qry);
             if(bn==true)
             {
                  javax.swing.JOptionPane.showMessageDialog(this,"Transaction completed." ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);
                  jLabel1.setText("");
                  jLabel2.setText("");
                  jLabel3.setText("");
                  jLabel4.setText("");
                  jTextField1.setText("");
                  jTextField1.requestFocus();
                  jLabel11.setText("");

                   loadData();
             }
             else
             {
                               javax.swing.JOptionPane.showMessageDialog(this,"Error......" ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);

             }
            }

        }
        else
        {
                  javax.swing.JOptionPane.showMessageDialog(this,"Enter valid purja number." ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);

        }
        }
        catch(NumberFormatException nfe)
        {
                   javax.swing.JOptionPane.showMessageDialog(this,"Invalied purja number." ,"Message Box",javax.swing.JOptionPane.INFORMATION_MESSAGE);

        }

}
public int purjaStatus()
{
        int purjaNumber=Integer.parseInt(""+jTextField1.getText());
        String qry1="select distinct customer_id from polish_details where purja_number="+purjaNumber+"";
        String customerId=Utility.getSingleValue(qry1);
        String qry2="select distinct status from polish_details where purja_number="+purjaNumber+"";
        int status=Integer.parseInt(""+Utility.getSingleValue(qry2));
        return status;



}

public void loadData()
 {      int one=1;
        int zero=0;
        dtm.setRowCount(0);
        String qry="select distinct purja_number,status,ac_code from polish_details where status="+zero+"";
        String[][] data=Utility.getInformationDD(qry,3);
       int length= data.length;
       String arr[]=new String[4];
       for(int i=0;i<length;i++)
       {   arr[0]=""+(i+1);
          String qry1="Select ac_name from ac_master where ac_code="+(Integer.parseInt(data[i][2]))+"";
          String customerName=Utility.getSingleValue(qry1);
          arr[1]=customerName;
           for(int j=0;j<2;j++)
           {
               if(j==1)
               {
                   String temp=""+data[i][1];
                   String work=null;
                   if(temp.equals("0"))
                   {
                       work="Polish Pending";
                   }
                   else if(temp.equals("1"))
                   {
                       work="Polish Done";
                   }
                    else if(temp.equals("2"))
                   {
                       work="Finish";
                   }
                   arr[3]=work;

               }
                else
               arr[j+2]=data[i][j];
           }
           dtm.addRow(arr);
       }

       
 }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextField jTextField1;
    // End of variables declaration//GEN-END:variables

}

